<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head> <title>On Storey’s direct approach to false discovery rates
Seminar for High-Dimensional Data</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (http://www.tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link type='text/css' rel='stylesheet' href='main.css' /> 
<meta content='main.tex' name='src' /> 
<script type='text/javascript' src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_CHTML'> </script> 
</head><body>
<div class='maketitle'>
                                                                                               
                                                                                               
                                                                                               
                                                                                               

<h2 class='titleHead'>On Storey’s direct approach to false discovery rates<br />
Seminar for High-Dimensional Data</h2>
<div class='author'><span class='ptmr7t-x-x-120'>Marko Lalović</span>
<br />   <span class='ptmr7t-x-x-120'>July 2019</span><br /></div>
<br />

<br />
</div>
<div class='abstract'>
<div class='centerline'>                                           <span class='ptmb7t-x-x-120'>Abstract</span>                                           </div>
Storey <span class='cite'>[<a href='#XStorey'>1</a>]</span> shed a new light on multiple-testing problem with the definition of positive false discovery rate measure and gave new
perspective with direct approach to false discovery rates.
<!-- l. 58 --><p class='noindent'>We provide formal introduction to multiple-testing problem and intuitive explanation of Storey’s direct approach. We demonstrate the
duality between Storey’s direct approach and Benjamini-Hochberg (BH) procedure <span class='cite'>[<a href='#XBH'>2</a>]</span> when using Storey’s estimate
<!-- l. 58 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of the proportion of
null hypotheses <!-- l. 58 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
in BH procedure.
</p><!-- l. 60 --><p class='noindent'>We show that the estimator <!-- l. 60 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of
the proportion of null hypotheses <!-- l. 60 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
plays a key role in multiple-testing problem and that the approach we take doesn’t matter much. We confirm this using simulations
where performances were practically identical for both methods.
</p><!-- l. 62 --><p class='noindent'>We show that Storey’s estimator <!-- l. 62 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
can be very upward biased when distance between distributions under null hypothesis and alternative hypotheses is small. In our simulations this upward bias
of <!-- l. 62 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> was reduced if we increased
the value of the tuning parameter <!-- l. 62 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
and especially by tuning this <!-- l. 62 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
parameter using the bootstrap method. However this bootstrap method can result in underestimation of
<!-- l. 62 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>, as
already explained in <span class='cite'>[<a href='#XBlack'>3</a>]</span>.
</p><!-- l. 64 --><p class='noindent'>In case of dependence Storey suggested the same approach <span class='cite'>[<a href='#XDependence'>4</a>]</span>. We show, this time only by simulation, that dependence can lead to a
very high overestimation of false discovery rate.
</p></div>
<!-- l. 67 --><p class='noindent'><span class='ptmbi7t-'>Keywords: </span>Multiple testing, Multiple comparisons, False discovery rate
                                                                                               
                                                                                               
</p>
<h3 class='likesectionHead'><a id='x1-1000'></a>Contents</h3>
<div class='tableofcontents'>
<span class='sectionToc'>1 <a id='QQ2-1-2' href='#x1-20001'>Introduction</a></span>
<br /> <span class='subsectionToc'>1.1 <a id='QQ2-1-3' href='#x1-30001.1'>Single-hypothesis testing</a></span>
<br /> <span class='subsectionToc'>1.2 <a id='QQ2-1-4' href='#x1-40001.2'>Multiple-hypothesis testing</a></span>
<br /> <span class='subsectionToc'>1.3 <a id='QQ2-1-5' href='#x1-50001.3'>Multiple-testing procedures</a></span>
<br />  <span class='subsubsectionToc'>1.3.1 <a id='QQ2-1-6' href='#x1-60001.3.1'>Bonferroni correction</a></span>
<br />  <span class='subsubsectionToc'>1.3.2 <a id='QQ2-1-7' href='#x1-70001.3.2'>Benjamini-Hochberg procedure</a></span>
<br />  <span class='subsubsectionToc'>1.3.3 <a id='QQ2-1-8' href='#x1-80001.3.3'>Storey’s approach</a></span>
<br /> <span class='subsectionToc'>1.4 <a id='QQ2-1-9' href='#x1-90001.4'>Overview</a></span>
<br /><span class='sectionToc'>2 <a id='QQ2-1-10' href='#x1-100002'>Derivation of Storey’s estimators for direct approach</a></span>
<br /><span class='sectionToc'>3 <a id='QQ2-1-11' href='#x1-110003'>Power comparison of Benjamini-Hochberg procedure and Storey’s direct approach</a></span>
<br /><span class='sectionToc'>4 <a id='QQ2-1-12' href='#x1-120004'>Using Storey’s estimator in Benjamini-Hochberg procedure</a></span>
<br /><span class='sectionToc'>5 <a id='QQ2-1-13' href='#x1-130005'>Properties of the Storey’s estimator</a></span>
<br /><span class='sectionToc'>6 <a id='QQ2-1-14' href='#x1-140006'>Storey’s bootstrap method for choosing the tuning parameter</a></span>
<br /><span class='sectionToc'>7 <a id='QQ2-1-15' href='#x1-150007'>Case of dependence</a></span>
<br /><span class='sectionToc'>8 <a id='QQ2-1-16' href='#x1-160008'>Conclusions</a></span>
</div>
<!-- l. 73 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>1    </span> <a id='x1-20001'></a>Introduction</h3>
<!-- l. 75 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>1.1    </span> <a id='x1-30001.1'></a>Single-hypothesis testing</h4>
<!-- l. 76 --><p class='noindent'>Following the scientific method, researchers normally want to establish the truth of a statement by showing that the opposite appears to be
false. In general, a <span class='ptmri7t-'>hypothesis </span>is a proposed explanation for a phenomenon that one can test. In statistics, the hypotheses involve a parameter
<!-- l. 76 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>𝜃</mi></math> whose value is unknown but must
lie in a certain parameter space <!-- l. 76 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>Ω</mi></math>.
We assume that <!-- l. 76 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>Ω</mi></math> can be partitioned
into two disjoint subsets <!-- l. 76 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Ω</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 76 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></math> and
define two hypotheses:
                                                                                               
                                                                                               
</p><!-- tex4ht:inline --><!-- l. 80 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align-star'>
                                           <mtr><mtd columnalign='right' class='align-odd'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext>: </mtext></mstyle><mi>𝜃</mi></mtd>                                           <mtd class='align-even'> <mo class='MathClass-rel'>∈</mo> <msub><mrow><mi>Ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mspace width='2em'></mspace></mtd>                                           <mtd columnalign='right' class='align-label'></mtd>                                           <mtd class='align-label'>
                                           <mspace width='2em'></mspace></mtd></mtr><mtr><mtd columnalign='right' class='align-odd'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub><mstyle class='text'><mtext>: </mtext></mstyle><mi>𝜃</mi></mtd>                                           <mtd class='align-even'> <mo class='MathClass-rel'>∈</mo> <msub><mrow><mi>Ω</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>.</mo><mspace width='2em'></mspace></mtd>                                           <mtd columnalign='right' class='align-label'></mtd>                                           <mtd class='align-label'>
<mspace width='2em'></mspace></mtd></mtr></mtable></math>
<!-- l. 82 --><p class='noindent'>The hypothesis <!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
is the statement that confirms the theory and it is called an <span class='ptmri7t-'>alternative hypothesis</span>. The opposite
<!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is called a
<span class='ptmri7t-'>null hypothesis</span>. We must decide which of the hypotheses appears to be true. A procedure for deciding this is called a <span class='ptmri7t-'>test procedure </span>or
simply a <span class='ptmri7t-'>test</span>. Before we have to decide which hypothesis to choose, we assume that we can observe a random sample
<!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle mathvariant='bold'><mi>X</mi></mstyle> <mo class='MathClass-rel'>=</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math> drawn from a distribution that
involves the unknown parameter <!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>𝜃</mi></math>.
Let <!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi> <mo class='MathClass-rel'>=</mo> <mi>r</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mstyle mathvariant='bold'><mi>X</mi></mstyle></mrow><mo class='MathClass-close'>)</mo></mrow></math> be a statistic
and let <!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>Γ</mi></math>
be a subset of the real line and suppose that the test procedure is of the form: reject
<!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> if
<!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi> <mo class='MathClass-rel'>∈</mo> <mi>Γ</mi></math>. Then
<!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi></math> is called a <span class='ptmri7t-'>test
</span><span class='ptmri7t-'>statistic </span>and <!-- l. 82 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>Γ</mi></math> a
<span class='ptmri7t-'>rejection region</span>. A problem of this type is called a <span class='ptmri7t-'>single-hypothesis testing</span>.
</p><!-- l. 84 --><p class='noindent'>In single-hypothesis testing we only have two kinds of errors we might make. A <span class='ptmri7t-'>type I error </span>occurs when we reject the null
<!-- l. 84 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> when in fact
<!-- l. 84 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is true. A <span class='ptmri7t-'>type II error </span>occurs
when we fail to reject the null <!-- l. 84 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
when in fact <!-- l. 84 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is false.
The <span class='ptmri7t-'>significance level </span><!-- l. 84 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
is the upper bound on the probability of type I error: </p><table class='equation'><tr><td> <a id='x1-3001r1'></a>
<!-- l. 85 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                  <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>T</mi> <mo class='MathClass-rel'>∈</mo> <mi>Γ</mi><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext> is in fact true </mtext></mstyle></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(1)</td></tr></table>
<!-- l. 89 --><p class='noindent'>The <span class='ptmri7t-'>detection power </span><!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>π</mi></math> of a test
is the probability of rejecting <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
when in fact <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is false. Statistical
                                                                                               
                                                                                               
practice is to choose the value of <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>,
say <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>01</mn></math>, and then find
the rejection region <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></math>
that maximizes the detection power and satisfies Eq. <a href='#x1-3001r1'>1<!-- tex4ht:ref: eq: condition1  --></a>, that probability of type I error is at most
<!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>. The detection
power <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>π</mi></math> is a function
of rejection region <!-- l. 89 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></math>: </p><table class='equation'><tr><td>
<a id='x1-3002r2'></a>
<!-- l. 90 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                               <mi>π</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>T</mi> <mo class='MathClass-rel'>∈</mo> <msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext> is in fact false </mtext></mstyle></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(2)</td></tr></table>
<!-- l. 94 --><p class='noindent'>Typically, rejection regions <!-- l. 94 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></math>
and <!-- l. 94 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Γ</mi></mrow><mrow><msup><mrow><mi>α</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math> for different
values <!-- l. 94 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
and <!-- l. 94 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>α</mi></mrow><mrow><mi>′</mi></mrow></msup></math>, are
nested in this sense: </p><table class='equation'><tr><td> <a id='x1-3003r3'></a>
<!-- l. 95 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mstyle class='text'><mtext>if</mtext></mstyle><mspace width='1em' class='quad'></mspace><mi>α</mi> <mo class='MathClass-rel'>&lt;</mo> <msup><mrow><mi>α</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='1em' class='quad'></mspace><mstyle class='text'><mtext>then</mtext></mstyle><mspace width='1em' class='quad'></mspace><msub><mrow><mi>Γ</mi></mrow><mrow>
<mi>α</mi></mrow></msub> <mo class='MathClass-rel'>⊂</mo> <msub><mrow><mi>Γ</mi></mrow><mrow><msup><mrow><mi>α</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(3)</td></tr></table>
<!-- l. 103 --><p class='noindent'>For the given observation <!-- l. 103 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi> <mo class='MathClass-rel'>=</mo> <mi>t</mi></math>, the smallest
significance level <!-- l. 103 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math> at which a null hypothesis
would be rejected, is called the <!-- l. 103 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math><span class='ptmri7t-'>-value</span>:
</p><table class='equation'><tr><td> <a id='x1-3004r4'></a>
<!-- l. 104 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mi>p</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>t</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo><mi class='qopname'> inf</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>α</mi> <mo class='MathClass-punc'>:</mo> <mi>t</mi> <mo class='MathClass-rel'>∈</mo> <msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(4)</td></tr></table>
                                                                                               
                                                                                               
<!-- l. 109 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>1.2    </span> <a id='x1-40001.2'></a>Multiple-hypothesis testing</h4>
<!-- l. 110 --><p class='noindent'>Now consider simultaneous testing a collection of <!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
hypotheses, called a <span class='ptmri7t-'>family of hypotheses </span><!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math>,
where for <!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>, we
test <!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> versus
<!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub></math> on the basis of test statistics
given in the form of p-values <!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math>.
Let <!-- l. 110 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>m</mi></mrow></msub></math> be
random variables, where </p><table class='equation-star'><tr><td>
<!-- l. 111 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
<mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mrow class='cases'> <mfenced separators='' open='{' close=''><mrow> <mtable align='axis' class='array' equalcolumns='false' style='' columnlines='none' equalrows='false'> <mtr><mtd columnalign='left' class='array'><mn>0</mn><mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></mstyle><mtext> is in fact true,</mtext></mstyle></mtd>
</mtr>  <mtr><mtd columnalign='left' class='array'><mn>1</mn><mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub></mstyle><mtext> is in fact true.</mtext></mstyle></mtd></mtr><!-- @{}l@{\quad }l@{} --></mtable>                                                                                                                                                                  </mrow></mfenced> </mrow>
</math></td></tr></table>
<!-- l. 118 --><p class='noindent'>A <span class='ptmri7t-'>multiple-testing procedure </span>is a decision function <!-- l. 118 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>,
which for a given p-values <!-- l. 118 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>p</mi></mrow><mrow><mi>m</mi></mrow></msub></math>
assigns decision values <!-- l. 118 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>D</mi></mrow><mrow><mi>m</mi></mrow></msub></math>: </p><table class='equation'><tr><td>
<a id='x1-4001r5'></a>
<!-- l. 119 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mi>ϕ</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc'>,</mo><mspace width='1em' class='quad'></mspace><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(5)</td></tr></table>
<!-- l. 122 --><p class='noindent'>where <!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>D</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>1</mn></math> if hypothesis
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is rejected and
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>D</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn></math> otherwise, for each
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>. Table <a href='#x1-4002r1'>1<!-- tex4ht:ref: tab: summary  --></a> describes the possible
outcomes from <!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> hypothesis tests, where
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>⊂</mo><mrow><mo class='MathClass-open'>{</mo><mrow><mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></mrow><mo class='MathClass-close'>}</mo></mrow></math> is the index of true null hypotheses,
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mo class='MathClass-rel'>|</mo><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-rel'>|</mo></math> is the number of true null hypotheses,
<!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>V</mi> <mo class='MathClass-rel'>=</mo><msubsup><mrow><mi class='MathClass-op'> ∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></msubsup><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow><msub><mrow><mi>D</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the number of true null hypotheses
which are rejected (type I errors), <!-- l. 122 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi> <mo class='MathClass-rel'>=</mo><msubsup><mrow><mi class='MathClass-op'> ∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></msubsup><msub><mrow><mi>D</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
                                                                                               
                                                                                               
is the number of all rejected null hypotheses, etc.
</p>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 124 --><p class='noindent'><a id='x1-4002r1'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-4' class='tabular'><colgroup id='TBL-4-1g'><col id='TBL-4-1' /><col id='TBL-4-2' /><col id='TBL-4-3' /><col id='TBL-4-4' /></colgroup><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-1-' style='vertical-align:baseline;'><td id='TBL-4-1-1' style='text-align:center; white-space:nowrap;' class='td11'>                                                                                  </td><td id='TBL-4-1-2' style='text-align:center; white-space:nowrap;' class='td11'>                                      Accepted                                                                                            </td><td id='TBL-4-1-3' style='text-align:center; white-space:nowrap;' class='td11'>                                      Rejected                                                                                            </td><td id='TBL-4-1-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        Total                                                                                               </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr class='vspace' style='font-size:2.24998pt'><td> </td><td> </td><td> </td><td> </td></tr><tr id='TBL-4-2-' style='vertical-align:baseline;'><td id='TBL-4-2-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 130 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-4-2-2' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 130 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>U</mi></math></td><td id='TBL-4-2-3' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 130 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>V</mi> </math></td><td id='TBL-4-2-4' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 130 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td>
</tr><tr id='TBL-4-3-' style='vertical-align:baseline;'><td id='TBL-4-3-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 131 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>{</mo><mrow><mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-bin'>∖</mo> <msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-4-3-2' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 131 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi></math></td><td id='TBL-4-3-3' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 131 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>S</mi></math></td><td id='TBL-4-3-4' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 131 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td>
</tr><tr id='TBL-4-4-' style='vertical-align:baseline;'><td id='TBL-4-4-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        Total                                                                                               </td><td id='TBL-4-4-2' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 132 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>W</mi></math></td><td id='TBL-4-4-3' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 132 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi></math></td><td id='TBL-4-4-4' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 132 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math></td></tr></table>
</div>
<a id='x1-4003'></a>
<figcaption class='caption'><span class='id'>Table 1:</span><span class='content'>All                                                possible                                                outcomes                                                from
<!-- l. 134 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
hypothesis tests.</span></figcaption><!-- tex4ht:label?: x1-4002r1  -->
                                                                                               
                                                                                               
</figure>
</div>
<!-- l. 139 --><p class='noindent'>If the decision function <!-- l. 139 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math> is based
on rejection region of the form <!-- l. 139 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mi>γ</mi></mrow><mo class='MathClass-close'>]</mo></mrow></math>
for some threshold <!-- l. 139 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>γ</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math>:
</p><table class='equation'><tr><td> <a id='x1-4004r6'></a>
<!-- l. 140 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                        <mi>ϕ</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(6)</td></tr></table>
<!-- l. 143 --><p class='noindent'>then the random variables <!-- l. 143 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>U</mi><mo class='MathClass-punc'>,</mo><mi>V</mi><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>R</mi></math>
depend only on this threshold <!-- l. 143 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>γ</mi></math>,
e.g. <!-- l. 143 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo><msubsup><mrow><mi class='MathClass-op'> ∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></msubsup><mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
</p><!-- l. 145 --><p class='noindent'>Good scientific practice requires the specification of certain type I error measure control to be done prior to the data analysis. The
problem is to find a multiple-testing procedure which maximizes detection power and satisfies certain conditions involving type I error
measures. A problem of this type is called a <span class='ptmri7t-'>multiple-testing problem</span>. It is described in <span class='cite'>[<a href='#XRHeller'>5</a>]</span> or in the context of assessing the feature
significance in <span class='cite'>[<a href='#XESL'>6</a>]</span>.
</p><!-- l. 147 --><p class='noindent'>We say that some multiple-testing procedure <!-- l. 147 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>
has <span class='ptmri7t-'>strong level </span><!-- l. 147 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
<span class='ptmri7t-'>control </span>of some error measure EM, if it satisfies the condition: </p><table class='equation'><tr><td> <a id='x1-4005r7'></a>
<!-- l. 148 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                            <mstyle class='text'><mtext>EM</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>α</mi>
</math></td><td class='eq-no'>(7)</td></tr></table>
<!-- l. 151 --><p class='noindent'>for  any  configuration  of  true  and  false  hypotheses  in  the  family  of
<!-- l. 151 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> hypotheses
<!-- l. 151 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math>.
</p><!-- l. 153 --><p class='noindent'>The first type I error measure that was suggested is the <span class='ptmri7t-'>family-wise error rate (FWER)</span>. This is the probability that we make at least one type I error
among the family <!-- l. 153 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math> of
<!-- l. 153 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> hypotheses using some
multiple-testing procedure <!-- l. 153 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>:
</p>
<table class='equation'><tr><td> <a id='x1-4006r8'></a>
                                                                                               
                                                                                               
<!-- l. 155 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                       <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>V</mi> <mo class='MathClass-rel'>≥</mo> <mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(8)</td></tr></table>
<h4 class='subsectionHead'><span class='titlemark'>1.3    </span> <a id='x1-50001.3'></a>Multiple-testing procedures</h4>
<!-- l. 163 --><p class='noindent'>
</p>
<h5 class='subsubsectionHead'><span class='titlemark'>1.3.1    </span> <a id='x1-60001.3.1'></a>Bonferroni correction</h5>
<!-- l. 165 --><p class='noindent'>Simple multiple-testing procedure is the Bonferroni correction with the following decision function
<!-- l. 165 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>. Reject
<!-- l. 165 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math>, if
<!-- l. 165 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-bin'>∕</mo><mi>m</mi></math>: </p><table class='equation'><tr><td>
<a id='x1-6001r9'></a>
<!-- l. 166 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                       <mi>ϕ</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>α</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(9)</td></tr></table>
<div class='newtheorem'>
<!-- l. 170 --><p class='noindent'><span class='head'>
<a id='x1-6002r1'></a>
<span class='ptmb7t-'>Proposition 1.</span>                        </span><span class='ptmri7t-'>Bonferroni                      correction                      ensures                      strong                      level</span>
<!-- l. 171 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
<span class='ptmri7t-'>control of FWER:</span>
</p>
</div>
<!-- l. 173 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 174 --><p class='noindent'><span class='head'>
                                                                                               
                                                                                               
<span class='ptmri7t-'>Proof.</span> </span></p><table class='equation'><tr><td> <a id='x1-6003r10'></a>
<!-- l. 174 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                 <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>Bonf.</mtext></mstyle></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><munder class='msub'><mrow><mo>⋃</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel'>∈</mo><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></munder><mrow><mo class='MathClass-open'>{</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>α</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac></mrow><mo class='MathClass-close'>}</mo></mrow></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≤</mo><munder class='msub'><mrow><mo>∑</mo>
   </mrow><mrow><mi>i</mi><mo class='MathClass-rel'>∈</mo><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></munder><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>α</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mfrac><mrow><mi>α</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(10)</td></tr></table>
                                                                                              □
</div>
<!-- l. 180 --><p class='noindent'>This control comes with no distributional assumptions (e.g. independence) on the test statistics (p-values) or assumptions on the proportion of null hypotheses
<!-- l. 180 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin'>∕</mo><mi>m</mi></math>. Unfortunately, Bonferroni correction
has very little detection power when <!-- l. 180 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
is large.
</p><!-- l. 182 --><p class='noindent'>Now we can try to improve detection power of this simple multiple-testing procedure by constructing an estimator
<!-- l. 182 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of the number of true null
hypotheses and simply replace <!-- l. 182 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
in decision function <!-- l. 182 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>
with the estimator <!-- l. 182 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> to get
a new decision function <!-- l. 182 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></math>:
</p><table class='equation'><tr><td> <a id='x1-6004r11'></a>
<!-- l. 183 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow>
<mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>α</mi></mrow> 
<mrow><mover accent='false'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></mrow></mfrac></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(11)</td></tr></table>
<!-- l. 187 --><p class='noindent'>If <!-- l. 187 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>&lt;</mo> <mi>m</mi></math>, we can achieve improvement in
detection power using <!-- l. 187 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></math> instead of
<!-- l. 187 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>, because the set of hypotheses
rejected by <!-- l. 187 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math> are contained in the
set of hypotheses rejected by <!-- l. 187 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></math>.
</p>
<div class='newtheorem'>
<!-- l. 189 --><p class='noindent'><span class='head'>
<a id='x1-6005r2'></a>
                                                                                               
                                                                                               
<span class='ptmb7t-'>Proposition 2.</span>  </span><span class='ptmri7t-'>If the estimator </span><!-- l. 190 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
<span class='ptmri7t-'>tends to at most overestimate </span><!-- l. 190 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math><span class='ptmri7t-'>:</span>
</p><table class='equation'><tr><td> <a id='x1-6006r12'></a>
<!-- l. 191 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                         <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≥</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(12)</td></tr></table>
<!-- l. 194 --><p class='noindent'><span class='ptmri7t-'>then improved Bonferroni correction </span><!-- l. 194 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
<span class='ptmri7t-'>satisfies strong level </span><!-- l. 194 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
<span class='ptmri7t-'>control:</span> </p><table class='equation'><tr><td> <a id='x1-6007r13'></a>
<!-- l. 195 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                          <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(13)</td></tr></table>
</div>
<!-- l. 199 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 200 --><p class='noindent'><span class='head'>
<span class='ptmri7t-'>Proof.</span> </span>Simply replace <!-- l. 200 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
with <!-- l. 200 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> in
the proof of Proposition <a href='#x1-6002r1'>1<!-- tex4ht:ref: prop: Bonf  --></a>: </p><table class='equation'><tr><td> <a id='x1-6008r14'></a>
                                                                                               
                                                                                               
<!-- l. 201 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                       <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> 
<mrow><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(14)</td></tr></table>
<!-- l. 204 --><p class='noindent'>Take expected value on both sides and use monotonicity of expected value and the fact that expected value of FWER is FWER: </p><table class='equation'><tr><td>
<a id='x1-6009r15'></a>
<!-- l. 205 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                      <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel'>≤</mo>  <mfrac><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> 
<mrow><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(15)</td></tr></table>
<!-- l. 208 --><p class='noindent'>Use <!-- l. 208 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≥</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math>: </p><table class='equation'><tr><td>
<a id='x1-6010r16'></a>
<!-- l. 209 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                    <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><msup><mrow><mi>ϕ</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel'>≤</mo>  <mfrac><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> 
<mrow><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo> <mi>α</mi> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(16)</td></tr></table>
                                                                                              □
</div>
<!-- l. 214 --><p class='noindent'>From this example of using FWER error measure and Bonferroni multiple-testing procedure we see, that
improvement in detection power and control of type I error measure depends on the properties of an estimator
<!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of
<!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math> (or equivalently
<!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of the proportion
<!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin'>∕</mo><mi>m</mi></math>) of the number of true null hypotheses
in the family <!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math>. More precisely,
lower expected value of estimator <!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>m</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
(<!-- l. 214 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>) leads to
a greater detection power, but it also affects type I error measure.
                                                                                               
                                                                                               
</p><!-- l. 217 --><p class='noindent'>
</p>
<h5 class='subsubsectionHead'><span class='titlemark'>1.3.2    </span> <a id='x1-70001.3.2'></a>Benjamini-Hochberg procedure</h5>
<!-- l. 219 --><p class='noindent'>Another way to improve the detection power is by using a more appropriate type I error measure. Benjamini and
Hochberg <span class='cite'>[<a href='#XBH'>2</a>]</span> introduced a new type I error measure called <span class='ptmri7t-'>false discovery rate (FDR)</span>. This is the expected
proportion of false positive results among all the rejected hypotheses when using some multiple-testing procedure
<!-- l. 219 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>:
</p>
<table class='equation'><tr><td> <a id='x1-7001r17'></a>
<!-- l. 221 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                  <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='(' close=')'><mrow><mfrac><mrow><mi>V</mi> </mrow>
<mrow><mi>R</mi></mrow></mfrac><mo class='MathClass-rel'>∣</mo><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow></mfenced> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(17)</td></tr></table>
<div class='newtheorem'>
<!-- l. 225 --><p class='noindent'><span class='head'>
<a id='x1-7002r3'></a>
<span class='ptmb7t-'>Proposition 3.</span>  </span><span class='ptmri7t-'>For any multiple-testing procedure </span><!-- l. 226 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math><span class='ptmri7t-'>:</span>
</p><table class='equation'><tr><td> <a id='x1-7003r18'></a>
<!-- l. 227 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                         <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo><msub><mrow><mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub>
</math></td><td class='eq-no'>(18)</td></tr></table>
<!-- l. 230 --><p class='noindent'><span class='ptmri7t-'>with equality if all null hypotheses in </span><!-- l. 230 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math>
<span class='ptmri7t-'>are true.</span>
</p>
</div>
<!-- l. 232 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 233 --><p class='noindent'><span class='head'>
                                                                                               
                                                                                               
<span class='ptmri7t-'>Proof.</span> </span></p><table class='equation'><tr><td> <a id='x1-7004r19'></a>
<!-- l. 233 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                          <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mfrac><mrow><mi>V</mi> </mrow>
<mrow><mi>R</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfenced> <mo class='MathClass-rel'>≤</mo><mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mi>1</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>V</mi> <mo class='MathClass-rel'>≥</mo> <mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfenced> <mo class='MathClass-rel'>=</mo><msub><mrow> <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(19)</td></tr></table>
<!-- l. 237 --><p class='noindent'>When all null hypotheses in <!-- l. 237 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi mathvariant='bold-script'>ℱ</mi></math>
are true, <!-- l. 237 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>V</mi> <mo class='MathClass-rel'>=</mo> <mi>R</mi></math>
and <!-- l. 237 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo><msub><mrow> <mstyle class='text'><mtext>FWER</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub><mo class='MathClass-punc'>.</mo></math>   □
</p>
</div>
<!-- l. 239 --><p class='noindent'>Therefore we might achieve improvement in detection power by controlling FDR error measure instead of FWER error
measure.
</p><!-- l. 241 --><p class='noindent'>The following multiple-testing procedure is called <span class='ptmri7t-'>Benjamini-Hochberg (BH) procedure</span>. For given level
<!-- l. 241 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>, given ordered,
observed p-values <!-- l. 241 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>m</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub></math>,
calculate: </p><table class='equation'><tr><td> <a id='x1-7005r20'></a>
<!-- l. 242 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                   <mover accent='false'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>max</mtext></mstyle><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>α</mi> <mo class='MathClass-bin'>⋅</mo> <mi>k</mi><mo class='MathClass-bin'>∕</mo><mi>m</mi></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(20)</td></tr></table>
<!-- l. 245 --><p class='noindent'>and reject all null hypotheses corresponding to <!-- l. 245 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>i</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub></math>
for <!-- l. 245 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>≤</mo><mover accent='false'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover></math>.
</p><!-- l. 247 --><p class='noindent'>For this procedure Benjamini and Hochberg <span class='cite'>[<a href='#XBH'>2</a>]</span> showed the following. If test statistics (in our case
<!-- l. 247 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values)
are independent and in some cases of dependence, regardless of the distribution of the test statistics (in our case distribution of
<!-- l. 247 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values) when
<!-- l. 247 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is false, this procedure
has a strong level <!-- l. 247 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
control of FDR. Moreover it satisfies the property: </p><table class='equation'><tr><td> <a id='x1-7006r21'></a>
                                                                                               
                                                                                               
<!-- l. 248 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                      <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub> <mo class='MathClass-rel'>≤</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>α</mi> <mo class='MathClass-rel'>≤</mo> <mi>α</mi><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(21)</td></tr></table>
<!-- l. 251 --><p class='noindent'>where <!-- l. 251 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is
the proportion of true null hypotheses: </p><table class='equation'><tr><td> <a id='x1-7007r22'></a>
<!-- l. 252 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                           <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mfrac><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> 
 <mrow><mi>m</mi></mrow></mfrac> <mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(22)</td></tr></table>
<!-- l. 257 --><p class='noindent'>
</p>
<h5 class='subsubsectionHead'><span class='titlemark'>1.3.3    </span> <a id='x1-80001.3.3'></a>Storey’s approach</h5>
<!-- l. 259 --><p class='noindent'>Storey suggested <span class='cite'>[<a href='#XStorey'>1</a>]</span> a modified version of FDR error measure called the <span class='ptmri7t-'>positive false discovery rate (pFDR)</span>: </p><table class='equation'><tr><td> <a id='x1-8001r23'></a>
<!-- l. 260 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                      <mstyle class='text'><mtext>pFDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='(' close=')'><mrow><mfrac><mrow><mi>V</mi> </mrow>
<mrow><mi>R</mi></mrow></mfrac><mo class='MathClass-rel'>∣</mo><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow></mfenced><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(23)</td></tr></table>
<!-- l. 263 --><p class='noindent'>when using some multiple-testing procedure <!-- l. 263 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ϕ</mi></math>.
It holds pFDR <!-- l. 263 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'> <mo class='MathClass-rel'>≤</mo></math>
FDR: </p><table class='equation'><tr><td> <a id='x1-8002r24'></a>
                                                                                               
                                                                                               
<!-- l. 264 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                <mstyle class='text'><mtext>pFDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>≤</mo><msub><mrow><mstyle class='text'><mtext>pFDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo><msub><mrow> <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(24)</td></tr></table>
<!-- l. 267 --><p class='noindent'>because <!-- l. 267 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≤</mo> <mn>1</mn></math>.
Therefore we might achieve improvement in detection power by controlling error measure pFDR instead of FDR. In case when
<!-- l. 267 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math> is much
less than 1, FDR error measure might be misleading and Storey’s pFDR error measure is more appropriate. pFDR error measure also
has a clean Bayesian interpretation, which we show in Chapter <a href='#x1-100002'>2<!-- tex4ht:ref: sec: estimates  --></a> and it is described in <span class='cite'>[<a href='#XBayesian'>7</a>]</span>.
</p><!-- l. 269 --><p class='noindent'>Storey suggested in <span class='cite'>[<a href='#XStorey'>1</a>]</span> a more direct approach to multiple-testing problem. Rather than fixing level
<!-- l. 269 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math> control of some error measure and
then estimating the rejection region (<!-- l. 269 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mover accent='true'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover></math>
in BH procedure) satisfying level <!-- l. 269 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>α</mi></math>
control (<!-- l. 269 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>FDR</mtext></mstyle> <mo class='MathClass-rel'>≤</mo> <mi>α</mi></math>
for BH procedure), we instead fix the rejection region and then estimate some error measure, preferably pFDR.
</p><!-- l. 271 --><p class='noindent'>Important part of Storey’s direct approach is Storey’s method of estimating the proportion of true null hypotheses
<!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin'>∕</mo><mi>m</mi></math>. For a good estimator of (p)FDR, we
require a good estimator of <!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>. This
problem of estimating <!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is described in <span class='cite'>[<a href='#XProportion1'>8</a>]</span>
and <span class='cite'>[<a href='#XProportion2'>9</a>]</span>. Storey’s method of estimating <!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
is based on the following idea. Since the <!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
observed p-values contain information about the proportion of true null hypotheses
<!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>, Storey introduces a
tuning parameter <!-- l. 271 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>∈</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
and use information in </p><table class='equation'><tr><td> <a id='x1-8003r25'></a>
<!-- l. 272 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                           <mfrac><mrow><mi>#</mi><mrow><mo class='MathClass-open'>{</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow></mrow>
  <mrow><mi>m</mi></mrow></mfrac>
</math></td><td class='eq-no'>(25)</td></tr></table>
<!-- l. 275 --><p class='noindent'>to estimate <!-- l. 275 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
</p><!-- l. 277 --><p class='noindent'>In cases where <!-- l. 277 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>&lt;</mo><mo class='MathClass-rel'>&lt;</mo> <mi>m</mi></math>
(or equivalently <!-- l. 277 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>&lt;</mo><mo class='MathClass-rel'>&lt;</mo> <mn>1</mn></math>),
direct approach using Storey’s estimators has much more detection power than BH procedure, which takes
<!-- l. 277 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> instead of
an estimate of <!-- l. 277 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
Equivalently, we can improve detection power of BH procedure by using an estimate of
<!-- l. 277 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math>, but it is
no longer guaranteed to achieve FDR control at the desired level. One advantage of using direct approach instead of BH procedure is
                                                                                               
                                                                                               
that we can estimate pFDR instead of FDR.
</p><!-- l. 280 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>1.4    </span> <a id='x1-90001.4'></a>Overview</h4>
<!-- l. 281 --><p class='noindent'>After the formal derivation of Storey’s estimators for direct approach in Section <a href='#x1-100002'>2<!-- tex4ht:ref: sec: estimates  --></a>, we present results in
Sections <a href='#x1-110003'>3<!-- tex4ht:ref: sec: 1st  --></a> and <a href='#x1-120004'>4<!-- tex4ht:ref: sec: 2nd  --></a> of detection power comparison of BH procedure and direct approach using Storey’s
estimators. We formally justify and generalize this results. In Section <a href='#x1-130005'>5<!-- tex4ht:ref: sec: properties  --></a> we show that Storey’s estimator
<!-- l. 281 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> can be very upward biased when
distance between distributions under <!-- l. 281 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 281 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math> is
small. It follows from Section <a href='#x1-100002'>2<!-- tex4ht:ref: sec: estimates  --></a> that the same bias is present in the estimation of type I error measure. Lastly in Section <a href='#x1-150007'>7<!-- tex4ht:ref: sec: dependence  --></a>, we show
with simulation that dependence can lead to very high overestimation of FDR.
</p><!-- l. 284 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>2    </span> <a id='x1-100002'></a>Derivation of Storey’s estimators for direct approach</h3>
<!-- l. 286 --><p class='noindent'>Direct multiple-testing procedure using Storey’s estimates is based on the following Theorem <a href='#x1-10002r4'>4<!-- tex4ht:ref: thm: pFDR  --></a>
which is valid under the following assumptions and the assumption that rejection region
<!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Γ</mi></mrow><mrow><mi>α</mi></mrow></msub></math> satisfies the nesting property Eq. <a href='#x1-3003r3'>3<!-- tex4ht:ref: eq: nesting  --></a>.
Consider simultaneous testing of <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
null hypotheses, where for <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>,
we test <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> versus
<!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub></math> on the basis of test statistics
<!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, given in the form of p-values
and where significance region is <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mi>γ</mi></mrow><mo class='MathClass-close'>]</mo></mrow></math>,
for a given threshold <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>γ</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math>.
Assume <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub><mover class='stackrel'><mrow><mo class='MathClass-rel'>∼</mo></mrow><mrow><mrow><mi mathvariant='italic'>iid</mi></mrow></mrow></mover><mstyle class='text'><mtext>Bernoulli</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math>,
where <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn></math> when
<!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is in fact true
and <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>1</mn></math> when
<!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is in fact false.
Assume <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is uniformly
distributed on <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>
when <!-- l. 286 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is
in fact true.
</p><!-- l. 288 --><p class='noindent'>Denote the density of <!-- l. 288 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
when <!-- l. 288 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is in fact
false, with <!-- l. 288 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>h</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>p</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math> for
<!-- l. 288 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi> <mo class='MathClass-rel'>∈</mo> <mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>.
</p><!-- l. 290 --><p class='noindent'>Moreover, the p-values <!-- l. 290 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math> are iid
continuous random variables <!-- l. 290 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>P</mi></math>
with density: </p><table class='equation'><tr><td> <a id='x1-10001r26'></a>
                                                                                               
                                                                                               
<!-- l. 291 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                <mi>f</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>p</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>+</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo> <mi>h</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>p</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo><mspace width='2em' class='qquad'></mspace><mi>p</mi> <mo class='MathClass-rel'>∈</mo> <mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(26)</td></tr></table>
<div class='newtheorem'>
<!-- l. 295 --><p class='noindent'><span class='head'>
<a id='x1-10002r4'></a>
<span class='ptmb7t-'>Theorem 4.</span>   </span><span class='ptmri7t-'>The posterior probability for a given implicit prior probability</span>
<!-- l. 296 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> <span class='ptmri7t-'>is:</span> </p><table class='equation'><tr><td>
<a id='x1-10003r27'></a>
<!-- l. 297 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                   <mstyle class='text'><mtext>pFDR</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(27)</td></tr></table>
</div>
<!-- l. 302 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 303 --><p class='noindent'><span class='head'>
<span class='ptmri7t-'>Proof.</span> </span>
                                                                                               
                                                                                               
</p><!-- tex4ht:inline --><!-- l. 308 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                     <mtr><mtd columnalign='right' class='align-odd'><mstyle class='text'><mtext>pFDR</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mtd>                     <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mfrac><mrow><mi>V</mi> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow>
<mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow></mfenced><mspace width='2em'></mspace></mtd>                                                                         <mtd columnalign='right' class='align-label'><mstyle id='x1-10004r28' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(28)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                     </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                            <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>k</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></munderover><mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mfrac><mrow><mi>V</mi> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow>
<mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi></mrow></mfenced> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='2em'></mspace></mtd>                                            <mtd columnalign='right' class='align-label'><mstyle id='x1-10005r29' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(29)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                     </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                            <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>k</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></munderover><mfrac><mrow><mn>1</mn></mrow>
<mrow><mi>k</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mi>V</mi> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi></mrow></mfenced> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='2em'></mspace></mtd>                                          <mtd columnalign='right' class='align-label'><mstyle id='x1-10006r30' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(30)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
<!-- l. 309 --><p class='noindent'>Given <!-- l. 309 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi></math> and assumption of independent
p-values, it follows that <!-- l. 309 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>V</mi> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math> is a
binomial random variable, with <!-- l. 309 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>k</mi></math>
trials and probability of success <!-- l. 309 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math>
with expected value: </p><table class='equation'><tr><td> <a id='x1-10007r31'></a>
<!-- l. 310 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                              <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mi>V</mi> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi></mrow></mfenced> <mo class='MathClass-rel'>=</mo> <mi>k</mi> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(31)</td></tr></table>
<!-- l. 313 --><p class='noindent'>Combining <a href='#x1-10006r30'>30<!-- tex4ht:ref: eq: pFDR  --></a> and <a href='#x1-10007r31'>31<!-- tex4ht:ref: eq: E  --></a> we get:
</p><!-- tex4ht:inline --><!-- l. 320 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                    <mtr><mtd columnalign='right' class='align-odd'><mstyle class='text'><mtext>pFDR</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mtd>                    <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>k</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></munderover><mfrac><mrow><mn>1</mn></mrow>
<mrow><mi>k</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo> <mi>k</mi> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='2em'></mspace></mtd>                                        <mtd columnalign='right' class='align-label'><mstyle id='x1-10008r32' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(32)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                    </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                           <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>k</mi><mo class='MathClass-rel'>=</mo><mn>1</mn></mrow><mrow><mi>m</mi></mrow></munderover><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>k</mi><mo class='MathClass-rel'>∣</mo><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='2em'></mspace></mtd>                                             <mtd columnalign='right' class='align-label'><mstyle id='x1-10009r33' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(33)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                    </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                           <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo> <mn>1</mn><mspace width='2em'></mspace></mtd>                                                                       <mtd columnalign='right' class='align-label'><mstyle id='x1-10010r34' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(34)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                    </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                           <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo><mspace width='2em'></mspace></mtd>                                                                         <mtd columnalign='right' class='align-label'><mstyle id='x1-10011r35' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(35)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
                                                                                              □
                                                                                               
                                                                                               
</div>
<!-- l. 323 --><p class='noindent'>For large <!-- l. 323 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> it doesn’t make much
difference whether we regard the <!-- l. 323 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
as being random due to the Strong law of large numbers. Using Theorem <a href='#x1-10002r4'>4<!-- tex4ht:ref: thm: pFDR  --></a> and Bayes’ theorem we can derive
</p><!-- tex4ht:inline --><!-- l. 328 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                              <mtr><mtd columnalign='right' class='align-odd'><mstyle class='text'><mtext>pFDR</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mtd>                              <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-rel'>∣</mo><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='2em'></mspace></mtd>                                                                      <mtd columnalign='right' class='align-label'><mstyle id='x1-10012r36' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(36)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                              </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                     <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mfrac><mrow><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi><mo class='MathClass-rel'>∣</mo><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
             <mrow><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac>             <mspace width='2em'></mspace></mtd>                                                            <mtd columnalign='right' class='align-label'><mstyle id='x1-10013r37' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(37)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
<!-- l. 329 --><p class='noindent'>Using notation <!-- l. 329 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>H</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math> and the nesting
property Eq. <a href='#x1-3003r3'>3<!-- tex4ht:ref: eq: nesting  --></a> it follows that <!-- l. 329 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>P</mi></math>
is uniformly distributed on <!-- l. 329 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
when <!-- l. 329 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math> is in fact
true for each <!-- l. 329 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>
and we finally get: </p><table class='equation'><tr><td> <a id='x1-10014r38'></a>
<!-- l. 330 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mstyle class='text'><mtext>pFDR</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>    <mfrac><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
<mrow><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(38)</td></tr></table>
<!-- l. 334 --><p class='noindent'>To estimate pFDR (or FDR), we need estimators of <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math>. Storey’s
estimator <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math> of
<!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is based on the following reasoning.
As before let <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>p</mi></mrow><mrow><mi>m</mi></mrow></msub></math> be the observed p-values.
Let <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>#</mi><mrow><mo class='MathClass-open'>{</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow></math> be the number of p-values
greater than some value of <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>. A large
majority of p-values in the interval <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mi>λ</mi><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>,
for <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
not too small, should correspond to the true null hypotheses, and thus come from the uniform distribution on
<!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>. This implies an expected
value of <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math> to be approximately
                                                                                               
                                                                                               
equal to the product <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and
the length of the interval <!-- l. 334 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>[</mo><mrow><mi>λ</mi><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>: </p><table class='equation'><tr><td>
<a id='x1-10015r39'></a>
<!-- l. 335 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                    <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>[</mo><mrow><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow><mo class='MathClass-close'>]</mo></mrow> <mo class='MathClass-rel'>≈</mo> <mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow>
</math></td><td class='eq-no'>(39)</td></tr></table>
<!-- l. 338 --><p class='noindent'>and an estimator of <!-- l. 338 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>:
</p><table class='equation'><tr><td> <a id='x1-10016r40'></a>
<!-- l. 339 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                       <mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>     <mfrac><mrow><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
<mrow><mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac>
</math></td><td class='eq-no'>(40)</td></tr></table>
<!-- l. 343 --><p class='noindent'>Natural estimate of <!-- l. 343 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math>
is </p><table class='equation'><tr><td> <a id='x1-10017r41'></a>
<!-- l. 344 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                       <mover accent='false'><mrow><mstyle class='text'><mtext>Pr</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mfrac><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
  <mrow><mi>m</mi></mrow></mfrac>  <mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(41)</td></tr></table>
<!-- l. 348 --><p class='noindent'>Since pFDR is conditioned on <!-- l. 348 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math> we need
to divide our estimate of pFDR by <!-- l. 348 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
Lower bound for <!-- l. 348 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
is </p><table class='equation'><tr><td> <a id='x1-10018r42'></a>
                                                                                               
                                                                                               
<!-- l. 349 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                          <mn>1</mn> <mo class='MathClass-bin'>−</mo> <msup><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow><mrow><mi>m</mi></mrow></msup><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(42)</td></tr></table>
<!-- l. 353 --><p class='noindent'>Finally we get an estimate of pFDR as </p><table class='equation'><tr><td> <a id='x1-10019r43'></a>
<!-- l. 354 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                          <mover accent='false'><mrow><mstyle class='text'><mtext>pFDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mi>λ</mi></mrow></msub><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>                    <mfrac><mrow><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
<mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-bin'>⋅</mo><mfenced separators='' open='(' close=')'><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <msup><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow><mrow><mi>m</mi></mrow></msup></mrow></mfenced> </mrow></mfrac>
</math></td><td class='eq-no'>(43)</td></tr></table>
<!-- l. 358 --><p class='noindent'>and since FDR is not conditioned on <!-- l. 358 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math>
we get an estimate of FDR as </p><table class='equation'><tr><td> <a id='x1-10020r44'></a>
<!-- l. 359 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                <mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mi>λ</mi></mrow></msub><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>          <mfrac><mrow><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
<mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>R</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>γ</mi></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>}</mo></mrow></mrow></mfrac><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(44)</td></tr></table>
<!-- l. 366 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>3    </span> <a id='x1-110003'></a>Power comparison of Benjamini-Hochberg procedure and Storey’s direct approach</h3>
<!-- l. 368 --><p class='noindent'>Let BH stand for Benjamini-Hochberg multiple-testing procedure and let ST stand for direct approach using Storey’s estimates
described in Section <a href='#x1-100002'>2<!-- tex4ht:ref: sec: estimates  --></a>.
</p>
<div class='newtheorem'>
<!-- l. 370 --><p class='noindent'><span class='head'>
<a id='x1-11001r5'></a>
                                                                                               
                                                                                               
<span class='ptmb7t-'>Proposition 5.</span>  </span><span class='ptmri7t-'>The detection power of BH procedure is always less or equal to the detection power of direct approach using
</span><span class='ptmri7t-'>Storey’s estimates.</span>
</p>
</div>
<!-- l. 373 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 374 --><p class='noindent'><span class='head'>
<span class='ptmri7t-'>Proof.</span> </span>Let <!-- l. 374 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>m</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub></math> be observed ordered
<!-- l. 374 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values and say that by using
Storey’s direct approach, we reject <!-- l. 374 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>l</mi></math>
hypotheses corresponding to the first <!-- l. 374 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>l</mi></math>
ordered observed <!-- l. 374 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values: </p><table class='equation'><tr><td>
<a id='x1-11002r45'></a>
<!-- l. 375 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mi>l</mi> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(45)</td></tr></table>
<!-- l. 378 --><p class='noindent'>Using Storey’s estimate of the proportion <!-- l. 378 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
of true null hypotheses we estimate false discovery rate of direct approach:
<!-- l. 378 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow>
<mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>. We then use BH procedure
with control at level <!-- l. 378 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>
and estimate the rejection region:
                                                                                               
                                                                                               
</p><!-- tex4ht:inline --><!-- l. 384 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                                  <mtr><mtd columnalign='right' class='align-odd'><mover accent='true'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover></mtd>                                  <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>k</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>}</mo></mrow><mspace width='2em'></mspace></mtd>                                                                    <mtd columnalign='right' class='align-label'><mstyle id='x1-11003r46' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(46)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                                  </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                    <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>k</mi></mrow> 
<mrow><mi>m</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><mfrac><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
  <mrow><mi>l</mi><mo class='MathClass-bin'>∕</mo><mi>m</mi></mrow></mfrac>  </mrow><mo class='MathClass-close'>}</mo></mrow><mspace width='2em'></mspace></mtd>                                                                     <mtd columnalign='right' class='align-label'><mstyle id='x1-11004r47' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(47)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                                  </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                    <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>k</mi> <mo class='MathClass-bin'>⋅</mo><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow> 
     <mrow><mi>l</mi></mrow></mfrac>    <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo><mspace width='2em'></mspace></mtd>                                                                      <mtd columnalign='right' class='align-label'><mstyle id='x1-11005r48' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(48)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
<!-- l. 385 --><p class='noindent'>Since <!-- l. 385 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mn>1</mn></math> it
follows that: </p><table class='equation'><tr><td> <a id='x1-11006r49'></a>
<!-- l. 386 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                            <mover accent='true'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover> <mo class='MathClass-rel'>≤</mo> <mi>l</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(49)</td></tr></table>
<!-- l. 389 --><p class='noindent'>More precisely the proportion of hypotheses rejected by BH procedure of all the hypotheses rejected by Storey’s direct approach is
<!-- l. 389 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>.    □
</p>
</div>
<!-- l. 391 --><p class='noindent'>From this proof we can see that increase in detection power of Storey’s direct approach over detection power of BH procedure depends on
<!-- l. 391 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and at the same time on
Storey’s estimator <!-- l. 391 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>, i.e. even if
<!-- l. 391 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is close to 0, there will be no
improvement in detection power, if <!-- l. 391 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></math>
is close to 1.
</p><!-- l. 393 --><p class='noindent'>We replicate the simulation study in <span class='cite'>[<a href='#XStorey'>1</a>]</span> to compare detection power of BH procedure with detection power of direct approach using
Storey’s estimates. We fix rejection region and tuning parameter in the following way. </p>
     <ul class='itemize1'>
     <li class='itemize'>Rejection region <!-- l. 395 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>Γ</mi> <mo class='MathClass-rel'>=</mo> <mrow><mo class='MathClass-open'>[</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>01</mn></mrow><mo class='MathClass-close'>]</mo></mrow></math>
     or equivalently threshold <!-- l. 395 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>γ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>01</mn></math>
     for direct approach.
     </li>
     <li class='itemize'>The value of tuning parameter <!-- l. 396 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>5</mn></math>
     for Storey’s estimation of <!-- l. 396 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mi mathvariant='italic'>ST</mi></mrow></msub></math>
     of false discovery rate <!-- l. 396 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mi mathvariant='italic'>ST</mi></mrow></msub></math>
     of direct approach.</li></ul>
                                                                                               
                                                                                               
<!-- l. 399 --><p class='noindent'>To put the two methods on equal ground for comparison, we use Storey’s estimates to get an estimate
<!-- l. 399 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mi mathvariant='italic'>ST</mi></mrow></msub></math>
of the false discovery rate. Then use BH procedure to control the false discovery rate
<!-- l. 399 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow>
<mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math> of BH procedure
at the level <!-- l. 399 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>.
</p><!-- l. 401 --><p class='noindent'>We do <!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi> <mo class='MathClass-rel'>=</mo> <mn>1000</mn></math> one sided tests of
null hypotheses where, for <!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>,
we test <!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub> <mo class='MathClass-punc'>:</mo> <mi>μ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn></math> versus
<!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub> <mo class='MathClass-punc'>:</mo> <mi>μ</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math> on the basis of
<!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values from simulated
random variables <!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>μ</mi><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>,
for <!-- l. 401 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math>.
</p><!-- l. 403 --><p class='noindent'>We limit the proportion <!-- l. 403 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
of null hypotheses <!-- l. 403 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
to: </p><table class='equation'><tr><td> <a id='x1-11007r50'></a>
<!-- l. 404 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                        <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>∈</mo><mrow><mo class='MathClass-open'>{</mo><mrow><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(50)</td></tr></table>
<!-- l. 407 --><p class='noindent'>The alternative distribution is <!-- l. 407 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>2</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
</p><!-- l. 409 --><p class='noindent'>The test statistics are in the form of observed <!-- l. 409 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values:
</p><table class='equation'><tr><td> <a id='x1-11008r51'></a>
<!-- l. 410 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                         <msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>Φ</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(51)</td></tr></table>
<!-- l. 413 --><p class='noindent'>where <!-- l. 413 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the
observed value of <!-- l. 413 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>.
</p><!-- l. 415 --><p class='noindent'>Let <!-- l. 415 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math> be the number of true
null hypotheses, <!-- l. 415 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mi>m</mi> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math> number
of false null hypotheses and <!-- l. 415 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>S</mi></math>
the number of in fact false null hypotheses which are rejected. We estimate the <span class='ptmri7t-'>average detection power </span>of both methods: </p><table class='equation'><tr><td>
<a id='x1-11009r52'></a>
                                                                                               
                                                                                               
<!-- l. 416 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                 <mstyle class='text'><mtext>Power</mtext></mstyle></mrow><mrow><mi>ϕ</mi></mrow></msub> <mo class='MathClass-rel'>=</mo>   <mfrac><mrow><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>S</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
<mrow><mi>m</mi> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac><mo class='MathClass-punc'>,</mo><mspace width='2em' class='qquad'></mspace><mi>ϕ</mi> <mo class='MathClass-rel'>∈</mo><mrow><mo class='MathClass-open'>{</mo><mrow><mstyle class='text'><mtext>ST</mtext></mstyle><mo class='MathClass-punc'>,</mo><mstyle class='text'><mtext>BH</mtext></mstyle></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(52)</td></tr></table>
<!-- l. 420 --><p class='noindent'>In this setup, the probability of rejection <!-- l. 420 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
is very close to 1 for both methods. This means that error measures pFDR and FDR are very
close to being equal. In our simulation we rejected at least one null hypotheses in each iteration
(<!-- l. 420 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math>), so
estimate <!-- l. 420 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>R</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>
was 1 and we only report FDR.
</p><!-- l. 422 --><p class='noindent'>Table <a href='#x1-11011r2'>2<!-- tex4ht:ref: tab: power  --></a> summarizes 1000 simulations with values almost identical to Table in <span class='cite'>[<a href='#XStorey'>1</a>]</span>. We see that Storey’s estimates are very close to
their true values. Estimated expected value of Storey’s estimate: </p><table class='equation'><tr><td> <a id='x1-11010r53'></a>
<!-- l. 423 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                           <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='(' close=')'><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow></mfenced>
</math></td><td class='eq-no'>(53)</td></tr></table>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 427 --><p class='noindent'><a id='x1-11011r2'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-5' class='tabular'><colgroup id='TBL-5-1g'><col id='TBL-5-1' /><col id='TBL-5-2' /><col id='TBL-5-3' /><col id='TBL-5-4' /><col id='TBL-5-5' /><col id='TBL-5-6' /><col id='TBL-5-7' /><col id='TBL-5-8' /></colgroup><tr id='TBL-5-1-' style='vertical-align:baseline;'><td id='TBL-5-1-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-5-1-2' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-5-1-3' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-5-1-4' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-5-1-5' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-5-1-6' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-5-1-7' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-5-1-8' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 430 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-2-' style='vertical-align:baseline;'><td id='TBL-5-2-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.1                                                                                                 </td><td id='TBL-5-2-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.003                                                                                                   </td><td id='TBL-5-2-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.000                                                                                                   </td><td id='TBL-5-2-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-5-2-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.074                                                                                                    </td><td id='TBL-5-2-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.004                                                                                               </td><td id='TBL-5-2-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.141                                                                                               </td><td id='TBL-5-2-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0000                                                                                              </td></tr><tr id='TBL-5-3-' style='vertical-align:baseline;'><td id='TBL-5-3-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.2 </td><td id='TBL-5-3-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.007 </td><td id='TBL-5-3-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.002 </td><td id='TBL-5-3-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.373 </td><td id='TBL-5-3-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.122 </td><td id='TBL-5-3-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.008 </td><td id='TBL-5-3-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.237 </td><td id='TBL-5-3-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0010</td>
</tr><tr id='TBL-5-4-' style='vertical-align:baseline;'><td id='TBL-5-4-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.3                                                                                                 </td><td id='TBL-5-4-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.011                                                                                                   </td><td id='TBL-5-4-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.004                                                                                                   </td><td id='TBL-5-4-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-5-4-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.164                                                                                                    </td><td id='TBL-5-4-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.013                                                                                               </td><td id='TBL-5-4-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.332                                                                                               </td><td id='TBL-5-4-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0010                                                                                              </td></tr><tr id='TBL-5-5-' style='vertical-align:baseline;'><td id='TBL-5-5-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.4 </td><td id='TBL-5-5-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.017 </td><td id='TBL-5-5-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.007 </td><td id='TBL-5-5-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.371 </td><td id='TBL-5-5-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.203 </td><td id='TBL-5-5-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.019 </td><td id='TBL-5-5-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.427 </td><td id='TBL-5-5-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0020</td>
</tr><tr id='TBL-5-6-' style='vertical-align:baseline;'><td id='TBL-5-6-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.5                                                                                                 </td><td id='TBL-5-6-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.026                                                                                                   </td><td id='TBL-5-6-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.014                                                                                                   </td><td id='TBL-5-6-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-5-6-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.235                                                                                                    </td><td id='TBL-5-6-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.027                                                                                               </td><td id='TBL-5-6-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.522                                                                                               </td><td id='TBL-5-6-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0030                                                                                              </td>
</tr><tr id='TBL-5-7-' style='vertical-align:baseline;'><td id='TBL-5-7-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.6                                                                                                 </td><td id='TBL-5-7-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.039                                                                                                   </td><td id='TBL-5-7-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.024                                                                                                   </td><td id='TBL-5-7-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.371                                                                                                    </td><td id='TBL-5-7-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.265                                                                                                    </td><td id='TBL-5-7-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.040                                                                                               </td><td id='TBL-5-7-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.618                                                                                               </td><td id='TBL-5-7-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0040                                                                                              </td>
</tr><tr id='TBL-5-8-' style='vertical-align:baseline;'><td id='TBL-5-8-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.7                                                                                                 </td><td id='TBL-5-8-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.059                                                                                                   </td><td id='TBL-5-8-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.041                                                                                                   </td><td id='TBL-5-8-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.373                                                                                                    </td><td id='TBL-5-8-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.294                                                                                                    </td><td id='TBL-5-8-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.060                                                                                               </td><td id='TBL-5-8-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.713                                                                                               </td><td id='TBL-5-8-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0050                                                                                              </td>
</tr><tr id='TBL-5-9-' style='vertical-align:baseline;'><td id='TBL-5-9-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.8                                                                                                 </td><td id='TBL-5-9-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.096                                                                                                   </td><td id='TBL-5-9-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.077                                                                                                   </td><td id='TBL-5-9-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-5-9-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.320                                                                                                    </td><td id='TBL-5-9-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.099                                                                                               </td><td id='TBL-5-9-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.809                                                                                               </td><td id='TBL-5-9-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0070                                                                                              </td>
</tr><tr id='TBL-5-10-' style='vertical-align:baseline;'><td id='TBL-5-10-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.9                                                                                                 </td><td id='TBL-5-10-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.194                                                                                                   </td><td id='TBL-5-10-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.174                                                                                                   </td><td id='TBL-5-10-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-5-10-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.343                                                                                                    </td><td id='TBL-5-10-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.199                                                                                               </td><td id='TBL-5-10-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.904                                                                                               </td><td id='TBL-5-10-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0080                                                                                              </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table>
</div>
<a id='x1-11012'></a>
<figcaption class='caption'><span class='id'>Table 2:</span><span class='content'>Average detection power comparison of BH procedure and direct approach.</span></figcaption><!-- tex4ht:label?: x1-11011r3  -->
                                                                                               
                                                                                               
</figure>
</div>
<!-- l. 447 --><p class='noindent'>of FDR for direct approach is almost always within 0.1% of actual FDR and always conservative. Estimated expected value of Storey’s
estimator of <!-- l. 447 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>: </p><table class='equation'><tr><td>
<a id='x1-11013r54'></a>
<!-- l. 448 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                            <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></mrow><mo class='MathClass-close'>)</mo></mrow>
</math></td><td class='eq-no'>(54)</td></tr></table>
<!-- l. 451 --><p class='noindent'>is always very close and conservative. Estimated expected value of the estimator
<!-- l. 451 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></math> of rejection
region threshold <!-- l. 451 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>γ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>01</mn></math>
when using Benjamini-Hochberg procedure is very conservative: </p><table class='equation'><tr><td> <a id='x1-11014r55'></a>
<!-- l. 452 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                        <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&lt;</mo><mo class='MathClass-rel'>&lt;</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>01</mn>
</math></td><td class='eq-no'>(55)</td></tr></table>
<!-- l. 455 --><p class='noindent'>in all the cases of <!-- l. 455 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>. Actual FDR for BH
procedure is a lot less than control <!-- l. 455 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>.
In Figure <a href='#x1-11015r1'>1<!-- tex4ht:ref: fig: power  --></a>, we see that for <!-- l. 455 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
close to 0, direct approach has much more detection power on average than BH procedure, which takes
<!-- l. 455 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math> instead of
an estimate of <!-- l. 455 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
</p>
<figure class='figure'> 

                                                                                               
                                                                                               
<a id='x1-11015r1'></a>
                                                                                               
                                                                                               
<!-- l. 459 --><p class='noindent'> <img alt='PIC' src='../data/power-.png' height='248' width='248' />
<a id='x1-11016'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 1:</span><span class='content'>Average detection power comparison of BH procedure and direct approach.</span></figcaption><!-- tex4ht:label?: x1-11015r3  -->
                                                                                               
                                                                                               
</figure>
<h3 class='sectionHead'><span class='titlemark'>4    </span> <a id='x1-120004'></a>Using Storey’s estimator in Benjamini-Hochberg procedure</h3>
<!-- l. 466 --><p class='noindent'>When using Storey’s estimate <!-- l. 466 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of the
proportion of true null hypotheses and <!-- l. 466 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math>
instead of <!-- l. 466 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
in Benjamini-Hochberg procedure, the detection power of this improved Benjamini-Hochberg procedure is almost identical to
Storey’s direct approach. Even more, we can show that it is always greater or equal to detection power of Storey’s direct
approach.
</p>
<div class='newtheorem'>
<!-- l. 468 --><p class='noindent'><span class='head'>
<a id='x1-12001r6'></a>
<span class='ptmb7t-'>Proposition 6.</span>  </span><span class='ptmri7t-'>When                                           using                                           Storey’s                                           estimate</span>
<!-- l. 469 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
<span class='ptmri7t-'>in  Benjamini-Hochberg  procedure  the  detection  power  of  Benjamini-Hochberg  procedure  is  always  greater  or  equal  to
</span><span class='ptmri7t-'>detection power of Storey’s direct approach.</span>
</p>
</div>
<!-- l. 472 --><p class='noindent'>
</p>
<div class='proof'>
<!-- l. 473 --><p class='noindent'><span class='head'>
<span class='ptmri7t-'>Proof.</span> </span>Let <!-- l. 473 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><msub><mrow><mi>p</mi></mrow><mrow><mi>m</mi></mrow></msub></math> be observed ordered
<!-- l. 473 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values and let’s say that by
using direct approach, we reject <!-- l. 473 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>l</mi></math>
hypotheses corresponding to the first <!-- l. 473 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>l</mi></math>
ordered observed <!-- l. 473 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values,
so: </p><table class='equation'><tr><td> <a id='x1-12002r56'></a>
<!-- l. 474 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mi>l</mi> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(56)</td></tr></table>
                                                                                               
                                                                                               
<!-- l. 477 --><p class='noindent'>We then use Storey’s method to estimate proportion <!-- l. 477 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
of true null hypotheses and from this estimate of false discovery rate:
<!-- l. 477 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow>
<mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>. We then use BH procedure
with control at level <!-- l. 477 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>
and <!-- l. 477 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math>
instead of <!-- l. 477 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
and calculate:
</p><!-- tex4ht:inline --><!-- l. 483 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                                 <mtr><mtd columnalign='right' class='align-odd'><mover accent='true'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover></mtd>                                 <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo>  <mfrac><mrow><mi>k</mi></mrow> 
<mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>}</mo></mrow><mspace width='2em'></mspace></mtd>                                                                  <mtd columnalign='right' class='align-label'><mstyle id='x1-12003r57' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(57)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                                 </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                   <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo>  <mfrac><mrow><mi>k</mi></mrow> 
<mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></mrow></mfrac> <mo class='MathClass-bin'>⋅</mo><mfrac><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
  <mrow><mi>l</mi><mo class='MathClass-bin'>∕</mo><mi>m</mi></mrow></mfrac>  </mrow><mo class='MathClass-close'>}</mo></mrow><mspace width='2em'></mspace></mtd>                                                                   <mtd columnalign='right' class='align-label'><mstyle id='x1-12004r58' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(58)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                                 </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                   <mtd class='align-even'> <mo class='MathClass-rel'>=</mo><mi class='qopname'> max</mi><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mrow><mo class='MathClass-open'>{</mo><mrow><mi>k</mi> <mo class='MathClass-punc'>:</mo> <msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>k</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mfrac><mrow><mi>k</mi> <mo class='MathClass-bin'>⋅</mo> <mi>γ</mi></mrow> 
  <mrow><mi>l</mi></mrow></mfrac>  </mrow><mo class='MathClass-close'>}</mo></mrow><mo class='MathClass-punc'>.</mo><mspace width='2em'></mspace></mtd>                                                                            <mtd columnalign='right' class='align-label'><mstyle id='x1-12005r59' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(59)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
<!-- l. 484 --><p class='noindent'>and because <!-- l. 484 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>p</mi></mrow><mrow><mrow><mo class='MathClass-open'>(</mo><mrow><mi>l</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></msub> <mo class='MathClass-rel'>≤</mo> <mi>γ</mi></math> it
follows that: </p><table class='equation'><tr><td> <a id='x1-12006r60'></a>
<!-- l. 485 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                            <mover accent='true'><mrow><mi>k</mi></mrow><mo accent='true'>̂</mo></mover> <mo class='MathClass-rel'>≥</mo> <mi>l</mi><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(60)</td></tr></table>
<!-- l. 488 --><p class='noindent'>So the set of hypotheses rejected by direct approach are contained in the set of hypotheses rejected by this improved BH
procedure.                                                                                                                                                                                    □
</p>
</div>
<!-- l. 491 --><p class='noindent'>For this simulation we use the same setup as in the first but in BH procedure we use Storey’s estimate
<!-- l. 491 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of the proportion of true
null hypotheses and <!-- l. 491 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math>
instead of <!-- l. 491 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>.
From summary of the results in Table <a href='#x1-12008r3'>3<!-- tex4ht:ref: tab: power_pi0_BH  --></a> and from Figure <a href='#x1-12010r2'>2<!-- tex4ht:ref: fig: power_pi0_BH  --></a> we see that estimated average detection power of BH procedure is always
greater than estimated average power of direct approach using Storey’s estimators: </p><table class='equation'><tr><td> <a id='x1-12007r61'></a>
                                                                                               
                                                                                               
<!-- l. 492 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
                                      <mstyle class='text'><mtext>Power</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub> <mo class='MathClass-rel'>≥</mo><msub><mrow><mstyle class='text'><mtext>Power</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(61)</td></tr></table>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 496 --><p class='noindent'><a id='x1-12008r3'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-6' class='tabular'><colgroup id='TBL-6-1g'><col id='TBL-6-1' /><col id='TBL-6-2' /><col id='TBL-6-3' /><col id='TBL-6-4' /><col id='TBL-6-5' /><col id='TBL-6-6' /><col id='TBL-6-7' /><col id='TBL-6-8' /></colgroup><tr id='TBL-6-1-' style='vertical-align:baseline;'><td id='TBL-6-1-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-6-1-2' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-6-1-3' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-6-1-4' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-6-1-5' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-6-1-6' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-6-1-7' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-6-1-8' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 499 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-6-2-' style='vertical-align:baseline;'><td id='TBL-6-2-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.1                                                                                                 </td><td id='TBL-6-2-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.003                                                                                                   </td><td id='TBL-6-2-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.003                                                                                                   </td><td id='TBL-6-2-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-6-2-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.373                                                                                                    </td><td id='TBL-6-2-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.004                                                                                               </td><td id='TBL-6-2-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.141                                                                                               </td><td id='TBL-6-2-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td></tr><tr id='TBL-6-3-' style='vertical-align:baseline;'><td id='TBL-6-3-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.2 </td><td id='TBL-6-3-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.007 </td><td id='TBL-6-3-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.007 </td><td id='TBL-6-3-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.372 </td><td id='TBL-6-3-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.373 </td><td id='TBL-6-3-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.008 </td><td id='TBL-6-3-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.237 </td><td id='TBL-6-3-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0100</td>
</tr><tr id='TBL-6-4-' style='vertical-align:baseline;'><td id='TBL-6-4-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.3                                                                                                 </td><td id='TBL-6-4-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.011                                                                                                   </td><td id='TBL-6-4-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.011                                                                                                   </td><td id='TBL-6-4-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-6-4-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.373                                                                                                    </td><td id='TBL-6-4-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.013                                                                                               </td><td id='TBL-6-4-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.332                                                                                               </td><td id='TBL-6-4-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td></tr><tr id='TBL-6-5-' style='vertical-align:baseline;'><td id='TBL-6-5-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.4 </td><td id='TBL-6-5-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.018 </td><td id='TBL-6-5-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.018 </td><td id='TBL-6-5-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.373 </td><td id='TBL-6-5-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.374 </td><td id='TBL-6-5-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.019 </td><td id='TBL-6-5-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.428 </td><td id='TBL-6-5-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0100</td>
</tr><tr id='TBL-6-6-' style='vertical-align:baseline;'><td id='TBL-6-6-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.5                                                                                                 </td><td id='TBL-6-6-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.026                                                                                                   </td><td id='TBL-6-6-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.026                                                                                                   </td><td id='TBL-6-6-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.373                                                                                                    </td><td id='TBL-6-6-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.374                                                                                                    </td><td id='TBL-6-6-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.027                                                                                               </td><td id='TBL-6-6-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.523                                                                                               </td><td id='TBL-6-6-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr id='TBL-6-7-' style='vertical-align:baseline;'><td id='TBL-6-7-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.6                                                                                                 </td><td id='TBL-6-7-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.039                                                                                                   </td><td id='TBL-6-7-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.039                                                                                                   </td><td id='TBL-6-7-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-6-7-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.373                                                                                                    </td><td id='TBL-6-7-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.040                                                                                               </td><td id='TBL-6-7-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.619                                                                                               </td><td id='TBL-6-7-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr id='TBL-6-8-' style='vertical-align:baseline;'><td id='TBL-6-8-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.7                                                                                                 </td><td id='TBL-6-8-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.057                                                                                                   </td><td id='TBL-6-8-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.058                                                                                                   </td><td id='TBL-6-8-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.374                                                                                                    </td><td id='TBL-6-8-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.376                                                                                                    </td><td id='TBL-6-8-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.060                                                                                               </td><td id='TBL-6-8-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.713                                                                                               </td><td id='TBL-6-8-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr id='TBL-6-9-' style='vertical-align:baseline;'><td id='TBL-6-9-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.8                                                                                                 </td><td id='TBL-6-9-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.098                                                                                                   </td><td id='TBL-6-9-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.099                                                                                                   </td><td id='TBL-6-9-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.372                                                                                                    </td><td id='TBL-6-9-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.375                                                                                                    </td><td id='TBL-6-9-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.099                                                                                               </td><td id='TBL-6-9-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.808                                                                                               </td><td id='TBL-6-9-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr id='TBL-6-10-' style='vertical-align:baseline;'><td id='TBL-6-10-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.9                                                                                                 </td><td id='TBL-6-10-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.193                                                                                                   </td><td id='TBL-6-10-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.197                                                                                                   </td><td id='TBL-6-10-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.371                                                                                                    </td><td id='TBL-6-10-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.377                                                                                                    </td><td id='TBL-6-10-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.200                                                                                               </td><td id='TBL-6-10-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.906                                                                                               </td><td id='TBL-6-10-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table>
</div>
<a id='x1-12009'></a>
<figcaption class='caption'><span class='id'>Table 3:</span><span class='content'>Average              detection              power              comparison              of              BH              procedure              using
<!-- l. 512 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math>
instead                                                                                                                                                                                        of
<!-- l. 512 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
and direct approach.</span></figcaption><!-- tex4ht:label?: x1-12008r4  -->
                                                                                               
                                                                                               
</figure>
</div>
<figure class='figure'> 

                                                                                               
                                                                                               
<a id='x1-12010r2'></a>
                                                                                               
                                                                                               
<!-- l. 519 --><p class='noindent'> <img alt='PIC' src='../data/power_pi0_BH-.png' height='248' width='248' />
<a id='x1-12011'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 2:</span><span class='content'>Average             detection             power             comparison             of             BH             procedure             using
<!-- l. 520 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mi>m</mi></math>
instead                                                                                                                                                                                        of
<!-- l. 520 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
and direct approach.</span></figcaption><!-- tex4ht:label?: x1-12010r4  -->
                                                                                               
                                                                                               
</figure>
<h3 class='sectionHead'><span class='titlemark'>5    </span> <a id='x1-130005'></a>Properties of the Storey’s estimator</h3>
<!-- l. 527 --><p class='noindent'>In the previous two sections we showed that the estimator of <!-- l. 527 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
plays a key role in detection power and in the estimation of error measure (p)FDR in the case of direct approach
or equivalently in the level of control of FDR in the case of improved BH procedure when using estimator of
<!-- l. 527 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>. Here we
inspect some properties of this estimator.
</p><!-- l. 529 --><p class='noindent'>Storey’s estimator of the proportion of null hypotheses <!-- l. 529 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
is: </p><table class='equation'><tr><td> <a id='x1-13001r62'></a>
<!-- l. 530 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                      <mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>     <mfrac><mrow><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
<mrow><mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(62)</td></tr></table>
<!-- l. 533 --><p class='noindent'>where <!-- l. 533 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>#</mi><mrow><mo class='MathClass-open'>{</mo><mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow></math> is the number of p-values
greater than some value of parameter <!-- l. 533 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>.
</p>
<div class='newtheorem'>
<!-- l. 535 --><p class='noindent'><span class='head'>
<a id='x1-13002r7'></a>
<span class='ptmb7t-'>Proposition 7.</span>  </span><span class='ptmri7t-'>For any fixed value of </span><!-- l. 536 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
<span class='ptmri7t-'>Storey’s estimator </span><!-- l. 536 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> <span class='ptmri7t-'>at
</span><span class='ptmri7t-'>most overestimates </span><!-- l. 536 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
<span class='ptmri7t-'>in expectation:</span> </p><table class='equation'><tr><td> <a id='x1-13003r63'></a>
<!-- l. 537 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                          <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≥</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(63)</td></tr></table>
</div>
<!-- l. 541 --><p class='noindent'>
</p>
                                                                                               
                                                                                               
<div class='proof'>
<!-- l. 542 --><p class='noindent'><span class='head'>
<span class='ptmri7t-'>Proof.</span> </span>Let <!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>U</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>#</mi><mrow><mo class='MathClass-open'>{</mo><mrow><mstyle class='text'><mtext>null </mtext></mstyle><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow></math> be the number of
<!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values from in fact true null
hypotheses which exceeds <!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math> and
<!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>T</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>#</mi><mrow><mo class='MathClass-open'>{</mo><mrow><mstyle class='text'><mtext>alternative </mtext></mstyle><msub><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>}</mo></mrow></math> corresponding number for the in
fact false null hypotheses. Then <!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>W</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mi>U</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>+</mo> <mi>T</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
If there are <!-- l. 542 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></math> in
fact true null hypotheses, then: </p><table class='equation'><tr><td> <a id='x1-13004r64'></a>
<!-- l. 543 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                     <mi>U</mi> <mo class='MathClass-rel'>∼</mo><mstyle class='text'><mtext>Binomial</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow>
</math></td><td class='eq-no'>(64)</td></tr></table>
<!-- l. 546 --><p class='noindent'>because <!-- l. 546 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>≥</mo> <mi>λ</mi><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></math>
and </p><table class='equation'><tr><td> <a id='x1-13005r65'></a>
<!-- l. 547 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                               <mi>T</mi> <mo class='MathClass-rel'>∼</mo><mstyle class='text'><mtext>Binomial</mtext></mstyle> <mfenced separators='' open='(' close=')'><mrow><mi>m</mi> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfenced><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(65)</td></tr></table>
<!-- l. 550 --><p class='noindent'>Putting all this together we get:
                                                                                               
                                                                                               
</p><!-- tex4ht:inline --><!-- l. 557 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><mtable columnalign='left' class='align'>
                           <mtr><mtd columnalign='right' class='align-odd'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mtd>                           <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mfrac><mrow><mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mi>U</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfenced> <mo class='MathClass-bin'>+</mo> <mstyle class='text'><mtext>E</mtext></mstyle> <mfenced separators='' open='[' close=']'><mrow><mi>T</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfenced></mrow> 
    <mrow><mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac>     <mspace width='2em'></mspace></mtd>                                                                         <mtd columnalign='right' class='align-label'><mstyle id='x1-13006r66' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(66)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                           </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <mfrac><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>+</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mi>m</mi> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
                   <mrow><mi>m</mi> <mo class='MathClass-bin'>⋅</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow><mo class='MathClass-close'>)</mo></mrow></mrow></mfrac>                    <mspace width='2em'></mspace></mtd>                                                      <mtd columnalign='right' class='align-label'><mstyle id='x1-13007r67' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(67)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                           </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                <mtd class='align-even'> <mo class='MathClass-rel'>=</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin'>+</mo> <mrow><mo class='MathClass-open'>(</mo><mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-bin'>⋅</mo><mfrac><mrow><mstyle class='text'><mtext>Pr</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>P</mi> <mo class='MathClass-rel'>&gt;</mo> <mi>λ</mi><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></mrow> 
      <mrow><mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>λ</mi></mrow></mfrac>     <mspace width='2em'></mspace></mtd>                                                               <mtd columnalign='right' class='align-label'><mstyle id='x1-13008r68' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(68)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
                           </mtd></mtr><mtr><mtd columnalign='right' class='align-odd'></mtd>                                <mtd class='align-even'> <mo class='MathClass-rel'>≥</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc'>.</mo><mspace width='2em'></mspace></mtd>                                                                                     <mtd columnalign='right' class='align-label'><mstyle id='x1-13009r69' class='label'></mstyle><!-- endlabel --><mstyle class='maketag'><mtext>(69)</mtext></mstyle><mspace width='0.33em' class='nbsp'></mspace>
</mtd></mtr></mtable></math>
                                                                                              □
</div>
<!-- l. 560 --><p class='noindent'>This inequality is guaranteed only in expectation and largely depends on a good choice of
<!-- l. 560 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>,
as can be seen from the plot in Figure <a href='#x1-13011r3'>3<!-- tex4ht:ref: fig: pi0_of_lambda  --></a>, where we choose the actual proportion of true null hypotheses to be 0.9: </p><table class='equation'><tr><td>
<a id='x1-13010r70'></a>
<!-- l. 561 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                            <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn>
</math></td><td class='eq-no'>(70)</td></tr></table>
<!-- l. 564 --><p class='noindent'>and vary the value of <!-- l. 564 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
in the range of <!-- l. 564 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
</p>
<figure class='figure'> 

                                                                                               
                                                                                               
<a id='x1-13011r3'></a>
                                                                                               
                                                                                               
<!-- l. 568 --><p class='noindent'> <img alt='PIC' src='../data/pi0_of_lambda-.png' height='248' width='248' />
<a id='x1-13012'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 3:</span><span class='content'>Storey’s estimate <!-- l. 569 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
of <!-- l. 569 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>
depending on the value of the parameter <!-- l. 569 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>.</span></figcaption><!-- tex4ht:label?: x1-13011r5  -->
                                                                                               
                                                                                               
</figure>
<!-- l. 573 --><p class='noindent'>We introduce a new parameter <!-- l. 573 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub></math> which is the
distance between the distributions associated with <!-- l. 573 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 573 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math>.
We use the same simulation setup described in Section <a href='#x1-110003'>3<!-- tex4ht:ref: sec: 1st  --></a> and simultaneously do
<!-- l. 573 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi> <mo class='MathClass-rel'>=</mo> <mn>1000</mn></math>
one sided tests of null hypotheses, where the test statistics are in the form of observed
<!-- l. 573 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values: </p><table class='equation'><tr><td>
<a id='x1-13013r71'></a>
<!-- l. 574 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                         <msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>1</mn> <mo class='MathClass-bin'>−</mo> <mi>Φ</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(71)</td></tr></table>
<!-- l. 577 --><p class='noindent'>where <!-- l. 577 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the
observed value of <!-- l. 577 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
under null hypothesis: </p><table class='equation'><tr><td> <a id='x1-13014r72'></a>
<!-- l. 578 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                        <msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow>
</math></td><td class='eq-no'>(72)</td></tr></table>
<!-- l. 582 --><p class='noindent'>and under alternative hypothesis: </p><table class='equation'><tr><td> <a id='x1-13015r73'></a>
<!-- l. 583 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                       <msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-rel'>∣</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(73)</td></tr></table>
<!-- l. 587 --><p class='noindent'>The estimates of <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math> over
the range of <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> depending
on the values of <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
                                                                                               
                                                                                               
and <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
are summarized in Table <a href='#x1-13016r4'>4<!-- tex4ht:ref: tab: bias  --></a>. We see that the estimated upward bias increases, especially when
<!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is small, if we decrease the
distance between the distributions <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
from 2 to 1. This is true in general and follows from Equation <a href='#x1-13008r68'>68<!-- tex4ht:ref: eq: bias  --></a> where we see the upward bias increases when probability of observing
<!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values corresponding to alternative
hypothesis <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math> that are greater than
<!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>, increases. This estimated upward
bias is reduced if we increase <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>,
in this case from <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>5</mn></math>
to <!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>.
This does not obviously follow from Equation <a href='#x1-13008r68'>68<!-- tex4ht:ref: eq: bias  --></a> and it is hard to say anything in general (maybe in the limit when
<!-- l. 587 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>→</mo> <mn>1</mn></math>).
</p><!-- l. 589 --><p class='noindent'>This same upward bias is present in estimates of FDR and pFDR, since estimate
<!-- l. 589 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
appears in the numerator of Storey’s estimates of FDR and pFDR. Because of this, we only report estimated
<!-- l. 589 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math> from this
simulation.
</p>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 591 --><p class='noindent'><a id='x1-13016r4'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-7' class='tabular'><colgroup id='TBL-7-1g'><col id='TBL-7-1' /><col id='TBL-7-2' /><col id='TBL-7-3' /><col id='TBL-7-4' /><col id='TBL-7-5' /></colgroup><tr id='TBL-7-1-' style='vertical-align:baseline;'><td id='TBL-7-1-1' style='text-align:center; white-space:nowrap;' class='td11'>                                                                                  </td><td id='TBL-7-1-2' style='text-align:center; white-space:nowrap;' class='td11' colspan='2'>                                          <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- l. 594 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>2</mn></math></div>                                                </td><td id='TBL-7-1-4' style='text-align:center; white-space:nowrap;' class='td11' colspan='2'>                                          <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- l. 594 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>1</mn></math></div>
</td></tr><tr id='TBL-7-2-' style='vertical-align:baseline;'><td id='TBL-7-2-1' style='text-align:center; white-space:nowrap;' class='td11'>                                                                                               </td><td id='TBL-7-2-2' style='text-align:center; white-space:nowrap;' class='td11' colspan='2'></td><td id='TBL-7-3-4' style='text-align:center; white-space:nowrap;' class='td11' colspan='2'></td></tr><tr id='TBL-7-5-' style='vertical-align:baseline;'><td id='TBL-7-5-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 596 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow>
<mn>0</mn></mrow></msub></math></td><td id='TBL-7-5-2' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 596 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>5</mn></math></td><td id='TBL-7-5-3' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 596 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math></td><td id='TBL-7-5-4' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 596 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>5</mn></math></td><td id='TBL-7-5-5' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 596 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math></td></tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-7-6-' style='vertical-align:baseline;'><td id='TBL-7-6-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.1 </td><td id='TBL-7-6-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.141 </td><td id='TBL-7-6-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.105 </td><td id='TBL-7-6-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.384 </td><td id='TBL-7-6-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.202</td>
</tr><tr id='TBL-7-7-' style='vertical-align:baseline;'><td id='TBL-7-7-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.2                                                                                                 </td><td id='TBL-7-7-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.236                                                                                               </td><td id='TBL-7-7-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.206                                                                                               </td><td id='TBL-7-7-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.454                                                                                               </td><td id='TBL-7-7-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.290                                                                                               </td>
</tr><tr id='TBL-7-8-' style='vertical-align:baseline;'><td id='TBL-7-8-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.3                                                                                                 </td><td id='TBL-7-8-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.332                                                                                               </td><td id='TBL-7-8-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.306                                                                                               </td><td id='TBL-7-8-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.522                                                                                               </td><td id='TBL-7-8-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.378                                                                                               </td>
</tr><tr id='TBL-7-9-' style='vertical-align:baseline;'><td id='TBL-7-9-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.4                                                                                                 </td><td id='TBL-7-9-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.428                                                                                               </td><td id='TBL-7-9-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.402                                                                                               </td><td id='TBL-7-9-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.590                                                                                               </td><td id='TBL-7-9-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.468                                                                                               </td>
</tr><tr id='TBL-7-10-' style='vertical-align:baseline;'><td id='TBL-7-10-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.5                                                                                                 </td><td id='TBL-7-10-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.523                                                                                               </td><td id='TBL-7-10-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.504                                                                                               </td><td id='TBL-7-10-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.658                                                                                               </td><td id='TBL-7-10-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.559                                                                                               </td>
</tr><tr id='TBL-7-11-' style='vertical-align:baseline;'><td id='TBL-7-11-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.6                                                                                                 </td><td id='TBL-7-11-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.618                                                                                               </td><td id='TBL-7-11-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.601                                                                                               </td><td id='TBL-7-11-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.727                                                                                               </td><td id='TBL-7-11-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.643                                                                                               </td>
</tr><tr id='TBL-7-12-' style='vertical-align:baseline;'><td id='TBL-7-12-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.7                                                                                                 </td><td id='TBL-7-12-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.715                                                                                               </td><td id='TBL-7-12-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.700                                                                                               </td><td id='TBL-7-12-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.795                                                                                               </td><td id='TBL-7-12-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.735                                                                                               </td>
</tr><tr id='TBL-7-13-' style='vertical-align:baseline;'><td id='TBL-7-13-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.8                                                                                                 </td><td id='TBL-7-13-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.808                                                                                               </td><td id='TBL-7-13-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.798                                                                                               </td><td id='TBL-7-13-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.864                                                                                               </td><td id='TBL-7-13-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.827                                                                                               </td>
</tr><tr id='TBL-7-14-' style='vertical-align:baseline;'><td id='TBL-7-14-1' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.9                                                                                                 </td><td id='TBL-7-14-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.906                                                                                               </td><td id='TBL-7-14-3' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.900                                                                                               </td><td id='TBL-7-14-4' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.930                                                                                               </td><td id='TBL-7-14-5' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.908                                                                                               </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table>
</div>
<a id='x1-13017'></a>
<figcaption class='caption'><span class='id'>Table 4:</span><span class='content'>Estimates <!-- l. 609 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math>
depending on the values of parameters <!-- l. 609 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>μ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
and <!-- l. 609 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>.</span></figcaption><!-- tex4ht:label?: x1-13016r5  -->
                                                                                               
                                                                                               
</figure>
</div>
<h3 class='sectionHead'><span class='titlemark'>6    </span> <a id='x1-140006'></a>Storey’s bootstrap method for choosing the tuning parameter</h3>
<!-- l. 614 --><p class='noindent'>Storey proposed <span class='cite'>[<a href='#XStorey'>1</a>]</span> a bootstrap procedure for choosing the optimal value
<!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>λ</mi></mrow><mrow><mi>B</mi></mrow></msup></math> of parameter
<!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math> which minimizes mean squared
error of <!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>. Using the same
setup as before in Section <a href='#x1-110003'>3<!-- tex4ht:ref: sec: 1st  --></a> we simultaneously do 1000 simulation of 1000 one sided tests and in each simulation use 1000 bootstrap samples (samples of
<!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values with replacements) to
estimate the optimal value <!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msup><mrow><mi>λ</mi></mrow><mrow><mi>B</mi></mrow></msup></math>.
Results are in Table <a href='#x1-14002r5'>5<!-- tex4ht:ref: tab: bootstrap  --></a>. We see the estimated expected value of this bootstrap estimator
<!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msubsup><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mi>B</mi></mrow></msubsup></mrow><mo class='MathClass-close'>)</mo></mrow></math> is very close
to the actual <!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
for all <!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> in
the range <!-- l. 614 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>.
</p><!-- l. 616 --><p class='noindent'>However in general the inequality: </p><table class='equation'><tr><td> <a id='x1-14001r74'></a>
<!-- l. 617 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                          <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≥</mo> <msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub>
</math></td><td class='eq-no'>(74)</td></tr></table>
<!-- l. 620 --><p class='noindent'>is no longer guaranteed for this estimator <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msubsup><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mi>B</mi></mrow></msubsup> <mo class='MathClass-rel'>=</mo><msub><mrow> <mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mrow><mo class='MathClass-open'>(</mo><mrow><msup><mrow><mi>λ</mi></mrow><mrow><mi>B</mi></mrow></msup></mrow><mo class='MathClass-close'>)</mo></mrow></math>.
The value of <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math> is no longer fixed.
In particular, choosing <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math> that is
associated with the smallest <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
(or with smallest <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mover accent='false'><mrow><mstyle class='text'><mtext>pFDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></math>) will result
in an underestimate of <!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
(and pFDR) as explained in <span class='cite'>[<a href='#XBlack'>3</a>]</span>. Storey and Tibshirani have proposed a cubic spline approach to estimating
<!-- l. 620 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
alleviate some of the difficulties associated with this bootstrap procedure.
</p>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 622 --><p class='noindent'><a id='x1-14002r5'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-8' class='tabular'><colgroup id='TBL-8-1g'><col id='TBL-8-1' /><col id='TBL-8-2' /></colgroup><tr id='TBL-8-1-' style='vertical-align:baseline;'><td id='TBL-8-1-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 625 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-8-1-2' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 625 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msubsup><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mi>B</mi></mrow></msubsup></mrow><mo class='MathClass-close'>)</mo></mrow></math></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-8-2-' style='vertical-align:baseline;'><td id='TBL-8-2-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.1                                                                                                 </td><td id='TBL-8-2-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.108                                                                                               </td></tr><tr id='TBL-8-3-' style='vertical-align:baseline;'><td id='TBL-8-3-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.2 </td><td id='TBL-8-3-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.207</td>
</tr><tr id='TBL-8-4-' style='vertical-align:baseline;'><td id='TBL-8-4-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.3                                                                                                 </td><td id='TBL-8-4-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.308                                                                                               </td></tr><tr id='TBL-8-5-' style='vertical-align:baseline;'><td id='TBL-8-5-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.4 </td><td id='TBL-8-5-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.404</td>
</tr><tr id='TBL-8-6-' style='vertical-align:baseline;'><td id='TBL-8-6-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.5                                                                                                 </td><td id='TBL-8-6-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.505                                                                                               </td>
</tr><tr id='TBL-8-7-' style='vertical-align:baseline;'><td id='TBL-8-7-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.6                                                                                                 </td><td id='TBL-8-7-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.603                                                                                               </td>
</tr><tr id='TBL-8-8-' style='vertical-align:baseline;'><td id='TBL-8-8-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.7                                                                                                 </td><td id='TBL-8-8-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.703                                                                                               </td>
</tr><tr id='TBL-8-9-' style='vertical-align:baseline;'><td id='TBL-8-9-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.8                                                                                                 </td><td id='TBL-8-9-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.804                                                                                               </td>
</tr><tr id='TBL-8-10-' style='vertical-align:baseline;'><td id='TBL-8-10-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.9                                                                                                 </td><td id='TBL-8-10-2' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.901                                                                                               </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr></table>
</div>
<a id='x1-14003'></a>
<figcaption class='caption'><span class='id'>Table 5:</span><span class='content'>Estimates <!-- l. 638 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msubsup><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mi>B</mi></mrow></msubsup></mrow><mo class='MathClass-close'>)</mo></mrow></math>.</span></figcaption><!-- tex4ht:label?: x1-14002r6  -->
                                                                                               
                                                                                               
</figure>
</div>
<h3 class='sectionHead'><span class='titlemark'>7    </span> <a id='x1-150007'></a>Case of dependence</h3>
<!-- l. 645 --><p class='noindent'>To simulate dependence, we introduce a new parameter <!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi></math>,
which is the degree of dependence between the distributions associated with
<!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and
<!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math>. We simultaneously do
<!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi> <mo class='MathClass-rel'>=</mo> <mn>1000</mn></math> one sided test of null
hypotheses, where we test <!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub> <mo class='MathClass-punc'>:</mo> <mi>μ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn></math>
versus <!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub> <mo class='MathClass-punc'>:</mo> <mi>μ</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn></math> on the basis of
<!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>p</mi></math>-values from simulated
dependent random variables <!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msubsup><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup></math>,
for <!-- l. 645 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mn>1</mn><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>.</mo><mo class='MathClass-punc'>,</mo><mi>m</mi></math> and: </p><table class='equation'><tr><td>
<a id='x1-15001r75'></a>
<!-- l. 646 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                         <msubsup><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-rel'>∼</mo> <msub><mrow><mi>Z</mi></mrow><mrow>
<mi>i</mi></mrow></msub> <mo class='MathClass-bin'>+</mo> <mi>M</mi><mo class='MathClass-punc'>,</mo>
</math></td><td class='eq-no'>(75)</td></tr></table>
<!-- l. 650 --><p class='noindent'>where <!-- l. 650 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>M</mi></math> is random
variable independent of <!-- l. 650 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
for each <!-- l. 650 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>i</mi></math>
and normally distributed with parameters: </p><table class='equation'><tr><td> <a id='x1-15002r76'></a>
<!-- l. 651 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                          <mi>M</mi> <mo class='MathClass-rel'>∼</mo> <mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mi>ρ</mi></mrow><mo class='MathClass-close'>)</mo></mrow>
</math></td><td class='eq-no'>(76)</td></tr></table>
<!-- l. 654 --><p class='noindent'>and <!-- l. 654 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is, as
in Section <a href='#x1-110003'>3<!-- tex4ht:ref: sec: 1st  --></a>, distributed: </p><table class='equation-star'><tr><td>
                                                                                               
                                                                                               
<!-- l. 655 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'><msub><mrow>
<mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel'>∼</mo><mrow class='cases'><mfenced separators='' open='{' close=''><mrow><mtable align='axis' class='array' equalcolumns='false' style='' columnlines='none' equalrows='false'><mtr><mtd columnalign='left' class='array'><mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>0</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></mstyle><mtext> is in fact true,</mtext></mstyle></mtd>
</mtr>  <mtr><mtd columnalign='left' class='array'><mi>N</mi><mrow><mo class='MathClass-open'>(</mo><mrow><mn>2</mn><mo class='MathClass-punc'>,</mo><mn>1</mn></mrow><mo class='MathClass-close'>)</mo></mrow><mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn><mi>i</mi></mrow></msub></mstyle><mtext> is in fact true.</mtext></mstyle></mtd></mtr>
<!-- @{}l@{\quad }l@{} --></mtable>                                                                                                                                                                                                       </mrow></mfenced> </mrow>
</math></td></tr></table>
<!-- l. 661 --><p class='noindent'>and proportion of in fact true null hypotheses <!-- l. 661 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn><mi>i</mi></mrow></msub></math>
is <!-- l. 661 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math> out of
all <!-- l. 661 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>m</mi></math>
hypotheses.
</p><!-- l. 663 --><p class='noindent'><!-- l. 663 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'></math>
<!-- l. 664 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'></math>
<!-- l. 665 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'></math>
</p><!-- l. 667 --><p class='noindent'>From  this  we  can  calculate  degree  of  dependence  in  terms  of
<!-- l. 667 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi></math>:
</p><table class='equation-star'><tr><td>
<!-- l. 668 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
<mstyle mathvariant='normal'><mi>Cov</mi></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-bin'>+</mo><mi>M</mi><mo class='MathClass-punc'>,</mo><msub><mrow><mi>Z</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-bin'>+</mo><mi>M</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mrow class='cases'> <mfenced separators='' open='{' close=''><mrow> <mtable align='axis' class='array' equalcolumns='false' style='' columnlines='none' equalrows='false'> <mtr><mtd columnalign='left' class='array'><mstyle mathvariant='normal'><mi>Cov</mi></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mi>M</mi><mo class='MathClass-punc'>,</mo><mi>M</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <msup><mrow><mi>ρ</mi></mrow><mrow><mn>2</mn></mrow></msup>         <mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><mi>i</mi><mo class='MathClass-rel'>≠</mo><mi>j</mi></mstyle><mtext>,</mtext></mstyle>  </mtd>
</mtr>  <mtr><mtd columnalign='left' class='array'><mstyle mathvariant='normal'><mi>Var</mi></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin'>+</mo> <mi>M</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mn>1</mn> <mo class='MathClass-bin'>+</mo> <msup><mrow><mi>ρ</mi></mrow><mrow><mn>2</mn></mrow></msup><mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mi>j</mi></mstyle><mtext></mtext></mstyle></mtd></mtr>
<!-- @{}l@{\quad }l@{} --></mtable>                                                                                                                              </mrow></mfenced></mrow>
</math></td></tr></table>
<!-- l. 674 --><p class='noindent'>and </p><table class='equation-star'><tr><td>
<!-- l. 675 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
<mstyle mathvariant='normal'><mi>Cor</mi></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-bin'>+</mo><mi>M</mi><mo class='MathClass-punc'>,</mo><msub><mrow><mi>Z</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-bin'>+</mo><mi>M</mi></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo> <mrow class='cases'> <mfenced separators='' open='{' close=''><mrow> <mtable align='axis' class='array' equalcolumns='false' style='' columnlines='none' equalrows='false'> <mtr><mtd columnalign='left' class='array'>  <mfrac><mrow><msup><mrow><mi>ρ</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow> 
<mrow><mn>1</mn><mo class='MathClass-bin'>+</mo><msup><mrow><mi>ρ</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac> <mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><mi>i</mi><mo class='MathClass-rel'>≠</mo><mi>j</mi></mstyle><mtext>,</mtext></mstyle>   </mtd>
</mtr>  <mtr><mtd columnalign='left' class='array'><mn>1</mn>     <mspace width='1em' class='quad'></mspace></mtd><mtd columnalign='left' class='array'><mstyle class='text'><mtext>if </mtext><mstyle class='math'><mi>i</mi> <mo class='MathClass-rel'>=</mo> <mi>j</mi></mstyle><mtext>.</mtext></mstyle></mtd></mtr>
<!-- @{}l@{\quad }l@{} --></mtable>                                                                                                                                                                                                       </mrow></mfenced> </mrow>
</math></td></tr></table>
                                                                                               
                                                                                               
<!-- l. 682 --><p class='noindent'>On Figure <a href='#x1-15006r4'>4<!-- tex4ht:ref: fig: dependence  --></a> we plotted upward bias of Storey’s estimator <!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>
if we fix <!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>
and vary <!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi></math>
in range from 0 to 0.9. And in Table <a href='#x1-15008r6'>6<!-- tex4ht:ref: tab: dependence  --></a> are summarized estimated Storey’s estimators and estimated
<!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math> of BH procedure
if we fix <!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>6</mn></math>
and vary <!-- l. 682 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
From Figure we see that degree of upward bias is very much influenced by the degree of dependence: </p><table class='equation'><tr><td> <a id='x1-15003r77'></a>
<!-- l. 683 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                 <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>&gt;</mo><mo class='MathClass-rel'>&gt;</mo><msub><mrow> <mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub><mo class='MathClass-punc'>,</mo><mspace width='2em' class='qquad'></mspace><mstyle class='text'><mtext>for </mtext></mstyle><mi>ρ</mi> <mo class='MathClass-rel'>&gt;</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(77)</td></tr></table>
<!-- l. 687 --><p class='noindent'>For example in our simulation for <!-- l. 687 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>6</mn></math>
or: </p><table class='equation'><tr><td> <a id='x1-15004r78'></a>
<!-- l. 688 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                                <mstyle mathvariant='normal'><mi>Cor</mi></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msubsup><mrow><mi>Z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc'>,</mo><msubsup><mrow><mi>Z</mi></mrow><mrow>
<mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>=</mo>    <mfrac><mrow><mn>0</mn><mo class='MathClass-punc'>.</mo><msup><mrow><mn>6</mn></mrow><mrow><mn>2</mn></mrow></msup></mrow> 
<mrow><mn>1</mn> <mo class='MathClass-bin'>+</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><msup><mrow><mn>6</mn></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac> <mo class='MathClass-rel'>≈</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>26</mn><mo class='MathClass-punc'>,</mo><mspace width='2em' class='qquad'></mspace><mi>i</mi><mo class='MathClass-rel'>≠</mo><mi>j</mi><mo class='MathClass-punc'>,</mo><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(78)</td></tr></table>
<!-- l. 691 --><p class='noindent'>and <!-- l. 691 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>, we
have: </p><table class='equation'><tr><td> <a id='x1-15005r79'></a>
<!-- l. 692 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='block' class='equation'>
                         <mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow> <mo class='MathClass-rel'>≈</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>482</mn> <mo class='MathClass-rel'>&gt;</mo> <mn>2</mn> <mo class='MathClass-bin'>⋅</mo><msub><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub> <mo class='MathClass-rel'>≈</mo> <mn>2</mn> <mo class='MathClass-bin'>⋅</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>228</mn> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>456</mn><mo class='MathClass-punc'>.</mo>
</math></td><td class='eq-no'>(79)</td></tr></table>
<!-- l. 695 --><p class='noindent'>So our simulation is showing that in this case Storey’s estimate of FDR is more than 2 times larger than actual FDR on average when
using direct approach.
</p>
<figure class='figure'> 

                                                                                               
                                                                                               
<a id='x1-15006r4'></a>
                                                                                               
                                                                                               
<!-- l. 700 --><p class='noindent'> <img alt='PIC' src='../data/FDR_of_ro-.png' height='248' width='248' />
<a id='x1-15007'></a>
</p>
<figcaption class='caption'><span class='id'>Figure 4:</span><span class='content'>Upward bias of Storey’s <!-- l. 701 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math>
depending on the value of the parameter <!-- l. 701 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi></math>,
where <!-- l. 701 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>9</mn></math>.</span></figcaption><!-- tex4ht:label?: x1-15006r7  -->
                                                                                               
                                                                                               
</figure>
<div class='table'>
                                                                                               
                                                                                               
<!-- l. 706 --><p class='noindent'><a id='x1-15008r6'></a></p><figure class='float'>
                                                                                               
                                                                                               
<div class='tabular'> <table id='TBL-12' class='tabular'><colgroup id='TBL-12-1g'><col id='TBL-12-1' /><col id='TBL-12-2' /><col id='TBL-12-3' /><col id='TBL-12-4' /><col id='TBL-12-5' /><col id='TBL-12-6' /><col id='TBL-12-7' /><col id='TBL-12-8' /></colgroup><tr id='TBL-12-1-' style='vertical-align:baseline;'><td id='TBL-12-1-1' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math></td><td id='TBL-12-1-2' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-12-1-3' style='text-align:center; white-space:nowrap;' class='td11'>FDR<!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-12-1-4' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></math></td><td id='TBL-12-1-5' style='text-align:center; white-space:nowrap;' class='td11'>Power<!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></math></td><td id='TBL-12-1-6' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mstyle class='text'><mtext>FDR</mtext></mstyle></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>ST</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-12-1-7' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><mover accent='false'><mrow><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>̂</mo></mover></mrow><mo class='MathClass-close'>)</mo></mrow></math></td><td id='TBL-12-1-8' style='text-align:center; white-space:nowrap;' class='td11'><!-- l. 709 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mstyle class='text'><mtext>E</mtext></mstyle><mrow><mo class='MathClass-open'>(</mo><mrow><msub><mrow><mover accent='false'><mrow><mi>γ</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mstyle class='text'><mtext>BH</mtext></mstyle></mrow></msub></mrow><mo class='MathClass-close'>)</mo></mrow></math></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-12-2-' style='vertical-align:baseline;'><td id='TBL-12-2-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.1                                                                                                 </td><td id='TBL-12-2-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.004                                                                                                   </td><td id='TBL-12-2-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.001                                                                                                   </td><td id='TBL-12-2-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.387                                                                                                    </td><td id='TBL-12-2-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.093                                                                                                    </td><td id='TBL-12-2-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.014                                                                                               </td><td id='TBL-12-2-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.178                                                                                               </td><td id='TBL-12-2-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0010                                                                                              </td></tr><tr id='TBL-12-3-' style='vertical-align:baseline;'><td id='TBL-12-3-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.2 </td><td id='TBL-12-3-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.010 </td><td id='TBL-12-3-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.002 </td><td id='TBL-12-3-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.386 </td><td id='TBL-12-3-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.142 </td><td id='TBL-12-3-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.027 </td><td id='TBL-12-3-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.275 </td><td id='TBL-12-3-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0030</td>
</tr><tr id='TBL-12-4-' style='vertical-align:baseline;'><td id='TBL-12-4-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.3                                                                                                 </td><td id='TBL-12-4-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.017                                                                                                   </td><td id='TBL-12-4-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.006                                                                                                   </td><td id='TBL-12-4-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.394                                                                                                    </td><td id='TBL-12-4-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.185                                                                                                    </td><td id='TBL-12-4-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.036                                                                                               </td><td id='TBL-12-4-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.358                                                                                               </td><td id='TBL-12-4-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0040                                                                                              </td></tr><tr id='TBL-12-5-' style='vertical-align:baseline;'><td id='TBL-12-5-1' style='text-align:center; white-space:nowrap;' class='td11'> 0.4 </td><td id='TBL-12-5-2' style='text-align:center; white-space:nowrap;' class='td11'> 0.024 </td><td id='TBL-12-5-3' style='text-align:center; white-space:nowrap;' class='td11'> 0.010 </td><td id='TBL-12-5-4' style='text-align:center; white-space:nowrap;' class='td11'> 0.380 </td><td id='TBL-12-5-5' style='text-align:center; white-space:nowrap;' class='td11'> 0.213 </td><td id='TBL-12-5-6' style='text-align:center; white-space:nowrap;' class='td11'> 0.049 </td><td id='TBL-12-5-7' style='text-align:center; white-space:nowrap;' class='td11'> 0.464 </td><td id='TBL-12-5-8' style='text-align:center; white-space:nowrap;' class='td11'> 0.0050</td>
</tr><tr id='TBL-12-6-' style='vertical-align:baseline;'><td id='TBL-12-6-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.5                                                                                                 </td><td id='TBL-12-6-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.038                                                                                                   </td><td id='TBL-12-6-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.018                                                                                                   </td><td id='TBL-12-6-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.396                                                                                                    </td><td id='TBL-12-6-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.257                                                                                                    </td><td id='TBL-12-6-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.079                                                                                               </td><td id='TBL-12-6-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.536                                                                                               </td><td id='TBL-12-6-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0090                                                                                              </td>
</tr><tr id='TBL-12-7-' style='vertical-align:baseline;'><td id='TBL-12-7-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.6                                                                                                 </td><td id='TBL-12-7-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.055                                                                                                   </td><td id='TBL-12-7-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.030                                                                                                   </td><td id='TBL-12-7-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.398                                                                                                    </td><td id='TBL-12-7-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.287                                                                                                    </td><td id='TBL-12-7-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.082                                                                                               </td><td id='TBL-12-7-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.621                                                                                               </td><td id='TBL-12-7-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0100                                                                                              </td>
</tr><tr id='TBL-12-8-' style='vertical-align:baseline;'><td id='TBL-12-8-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.7                                                                                                 </td><td id='TBL-12-8-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.077                                                                                                   </td><td id='TBL-12-8-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.052                                                                                                   </td><td id='TBL-12-8-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.387                                                                                                    </td><td id='TBL-12-8-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.316                                                                                                    </td><td id='TBL-12-8-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.136                                                                                               </td><td id='TBL-12-8-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.730                                                                                               </td><td id='TBL-12-8-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0180                                                                                              </td>
</tr><tr id='TBL-12-9-' style='vertical-align:baseline;'><td id='TBL-12-9-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.8                                                                                                 </td><td id='TBL-12-9-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.128                                                                                                   </td><td id='TBL-12-9-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.103                                                                                                   </td><td id='TBL-12-9-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.394                                                                                                    </td><td id='TBL-12-9-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.351                                                                                                    </td><td id='TBL-12-9-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.242                                                                                               </td><td id='TBL-12-9-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.810                                                                                               </td><td id='TBL-12-9-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0300                                                                                              </td>
</tr><tr id='TBL-12-10-' style='vertical-align:baseline;'><td id='TBL-12-10-1' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.9                                                                                                 </td><td id='TBL-12-10-2' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.228                                                                                                   </td><td id='TBL-12-10-3' style='text-align:center; white-space:nowrap;' class='td11'>                                         0.256                                                                                                   </td><td id='TBL-12-10-4' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.390                                                                                                    </td><td id='TBL-12-10-5' style='text-align:center; white-space:nowrap;' class='td11'>                                          0.428                                                                                                    </td><td id='TBL-12-10-6' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.482                                                                                               </td><td id='TBL-12-10-7' style='text-align:center; white-space:nowrap;' class='td11'>                                        0.908                                                                                               </td><td id='TBL-12-10-8' style='text-align:center; white-space:nowrap;' class='td11'>                                       0.0910                                                                                              </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table>
</div>
<a id='x1-15009'></a>
<figcaption class='caption'><span class='id'>Table 6:</span><span class='content'>Upward bias of estimators in case of dependence <!-- l. 722 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>ρ</mi> <mo class='MathClass-rel'>=</mo> <mn>0</mn><mo class='MathClass-punc'>.</mo><mn>6</mn></math>.</span></figcaption><!-- tex4ht:label?: x1-15008r7  -->
                                                                                               
                                                                                               
</figure>
</div>
<h3 class='sectionHead'><span class='titlemark'>8    </span> <a id='x1-160008'></a>Conclusions</h3>
<!-- l. 727 --><p class='noindent'>We illustrate the duality between Storey’s direct approach and Benjamini-Hochberg (BH) procedure when using Storey’s estimate
<!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> of proportion of
null hypotheses <!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
in BH procedure. The performances of the two methods are almost identical in our simulations. This demonstrates that the estimator of
<!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
plays a key role in multiple hypotheses testing. We show that Storey’s estimator
<!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
can be very upward biased when distance between distribution under null hypothesis
<!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and distribution under alternative
hypotheses <!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub></math> is small. In our simulations
this upward bias of <!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mover accent='false'><mrow><mi>π</mi></mrow><mo accent='true'>̂</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math> is reduced
if we increase the value of <!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math> and
especially by tuning the parameter <!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><mi>λ</mi></math>
using Storey’s bootstrap method. However this bootstrap method can result in underestimation of
<!-- l. 727 --><math xmlns='http://www.w3.org/1998/Math/MathML' display='inline'><msub><mrow><mi>π</mi></mrow><mrow><mn>0</mn></mrow></msub></math>. In case
of dependence, we show by using simulation that dependence can lead to a very high overestimation of FDR.
</p><!-- l. 729 --><p class='noindent'>Source code for the simulations is available at:
</p><!-- l. 731 --><p class='noindent'><a href='https://github.com/markolalovic/direct-approach-to-fdr' class='url'><span class='pcrr7t-'>https://github.com/markolalovic/direct-approach-to-fdr</span></a>
</p><!-- l. 1 --><p class='noindent'>
</p>
<h3 class='likesectionHead'><a id='x1-170008'></a>References</h3>
<!-- l. 1 --><p class='noindent'>
   </p><div class='thebibliography'>
   <p class='bibitem'><span class='biblabel'>
 [1]<span class='bibsp'>   </span></span><a id='XStorey'></a>J. D. Storey, “A direct approach to false discovery rates,” <span class='ptmri7t-'>Journal of the Royal Statistical Society: Series B (Statistical
   </span><span class='ptmri7t-'>Methodology). Vol. 64(3)</span>, 2002.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [2]<span class='bibsp'>   </span></span><a id='XBH'></a>Y. Benjamini and Y. Hochberg, “Controlling the false discovery rate: a practical and powerful approach to multiple
   testing,” <span class='ptmri7t-'>Journal of the Royal Statistical Society, Series B. 57(1)</span>, 1995.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [3]<span class='bibsp'>   </span></span><a id='XBlack'></a>M. A. Black, “A note on the adaptive control of false discovery rates,” <span class='ptmri7t-'>Journal of the Royal Statistical Society Series
   </span><span class='ptmri7t-'>B (Statistical Methodology) 66(2):297-304</span>, 2004.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [4]<span class='bibsp'>   </span></span><a id='XDependence'></a>J. D. Storey and R. Tibshirani, “Estimating the positive false discovery rate under dependence, with applications to
   dna microarrays,” <span class='ptmri7t-'>Stanford Statistics Technical Report. No. 2001-28</span>, 2001.
                                                                                               
                                                                                               
   </p>
   <p class='bibitem'><span class='biblabel'>
 [5]<span class='bibsp'>   </span></span><a id='XRHeller'></a>R. Heller,          “False          discovery          rate          control          in          multiple          testing          problems.”
   <a href='http://www.statistics.org.il/wp-content/uploads/2013/04/FDR-Ruth-Heller.pdf' class='url'><span class='pcrr7t-'>http://www.statistics.org.il/wp-content/uploads/2013/04/FDR-Ruth-Heller.pdf</span></a>, 2013.
   Accessed: 2019-10-24.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [6]<span class='bibsp'>   </span></span><a id='XESL'></a>T. Hastie,  R. Tibshirani,  and  J. Friedman,  <span class='ptmri7t-'>The  Elements  of  Statistical  Learning:  Data  Mining,  Inference,  and
   </span><span class='ptmri7t-'>Prediction</span>. Springer series in statistics, Springer, 2009.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [7]<span class='bibsp'>   </span></span><a id='XBayesian'></a>J. D. Storey, “The positive false discovery rate: A bayesian interpretation and the q-value,” <span class='ptmri7t-'>The Annals of Statistics:
   </span><span class='ptmri7t-'>Vol. 31(6)</span>, 2003.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [8]<span class='bibsp'>   </span></span><a id='XProportion1'></a>M. Langaas,  B. H.  Lindqvist,  and  E. Ferkingstad,  “Estimating  the  proportion  of  true  null  hypotheses,  with
   application to dna microarray data,” <span class='ptmri7t-'>Journal of the Royal Statistical Society. Series B. Vol. 67(4)</span>, 2005.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [9]<span class='bibsp'>   </span></span><a id='XProportion2'></a>O. Oyeniran and H. Chen, “Estimating the proportion of true null hypotheses in multiple testing problems,” <span class='ptmri7t-'>Journal
   </span><span class='ptmri7t-'>of Probability and Statistics. Vol. 2016</span>, 2016.
</p>
   </div>
 
</body> 
</html>